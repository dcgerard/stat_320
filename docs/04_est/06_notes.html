<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Gerard">
<meta name="dcterms.date" content="2025-09-16">

<title>Chapter 6 Notes: Estimation – Stat 320: Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b651517ce65839d647a86e2780455cfb.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0d4a9d19931feb4fee1ddab4b2489000.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stat 320: Biostatistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#estimation-set-up" id="toc-estimation-set-up" class="nav-link active" data-scroll-target="#estimation-set-up">Estimation Set up</a></li>
  <li><a href="#estimating-the-mean" id="toc-estimating-the-mean" class="nav-link" data-scroll-target="#estimating-the-mean">Estimating the Mean</a></li>
  <li><a href="#interval-estimation" id="toc-interval-estimation" class="nav-link" data-scroll-target="#interval-estimation">Interval Estimation</a>
  <ul class="collapse">
  <li><a href="#when-variance-is-not-known" id="toc-when-variance-is-not-known" class="nav-link" data-scroll-target="#when-variance-is-not-known">When Variance is Not Known</a></li>
  </ul></li>
  <li><a href="#estimate-variance" id="toc-estimate-variance" class="nav-link" data-scroll-target="#estimate-variance">Estimate Variance:</a></li>
  <li><a href="#estimate-binomial-proportion" id="toc-estimate-binomial-proportion" class="nav-link" data-scroll-target="#estimate-binomial-proportion">Estimate Binomial Proportion</a>
  <ul class="collapse">
  <li><a href="#exact-test" id="toc-exact-test" class="nav-link" data-scroll-target="#exact-test">Exact test</a></li>
  </ul></li>
  <li><a href="#estimate-poisson-mean" id="toc-estimate-poisson-mean" class="nav-link" data-scroll-target="#estimate-poisson-mean">Estimate Poisson Mean</a></li>
  <li><a href="#one-sided-ci-if-we-have-time" id="toc-one-sided-ci-if-we-have-time" class="nav-link" data-scroll-target="#one-sided-ci-if-we-have-time">One-sided CI (if we have time)</a></li>
  <li><a href="#exercises-6.5-6.10" id="toc-exercises-6.5-6.10" class="nav-link" data-scroll-target="#exercises-6.5-6.10">Exercises 6.5 – 6.10</a></li>
  <li><a href="#exercises-6.11-6.17" id="toc-exercises-6.11-6.17" class="nav-link" data-scroll-target="#exercises-6.11-6.17">Exercises 6.11 – 6.17</a></li>
  <li><a href="#exercises-6.77-6.80" id="toc-exercises-6.77-6.80" class="nav-link" data-scroll-target="#exercises-6.77-6.80">Exercises 6.77 – 6.80</a></li>
  <li><a href="#exercises-6.102-6.103" id="toc-exercises-6.102-6.103" class="nav-link" data-scroll-target="#exercises-6.102-6.103">Exercises 6.102 – 6.103</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 6 Notes: Estimation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Gerard </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 16, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="estimation-set-up" class="level1">
<h1>Estimation Set up</h1>
<div style="text-align: center;">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram-v2
    state "Data Generating Process" as Process
    Process --&gt; Data: Probability
    Data --&gt; Process: Inference
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<ul>
<li><p>Probability (Chapters 3, 4, and 5):</p>
<ul>
<li>We know that <span class="math inline">\(X \sim N(80, 12)\)</span><br>
</li>
<li>What is <span class="math inline">\(\Pr(X &gt; 90)\)</span>?</li>
</ul></li>
<li><p>Inference (Chapters 6 through 14):</p>
<ul>
<li>We observe <span class="math inline">\(X_i = 81, 78, 77, 89, \ldots\)</span><br>
</li>
<li>We assume <span class="math inline">\(X_i \sim N(\mu, \sigma^2)\)</span>
<ul>
<li>But the values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown.</li>
</ul></li>
<li>What are <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>?</li>
</ul></li>
<li><p><strong>Estimation</strong>: Guess parameter values from data</p>
<ul>
<li><strong>Point estimation</strong>: A single number is your best guess
<ul>
<li>E.g., estimate <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\bar{X}\)</span></li>
</ul></li>
<li><strong>Interval estimation</strong>: Get a range of likely values of a parameter
<ul>
<li>E.g., confidence intervals</li>
</ul></li>
</ul></li>
<li><p><strong>Hypothesis testing</strong>: How sure are we a parameter is different from some value?</p>
<ul>
<li>E.g., <span class="math inline">\(H_0: \mu = 0\)</span></li>
</ul></li>
</ul>
<p><img src="./04_figs/pop_to_sample/pop_to_sample.png" class="img-fluid">&nbsp;</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Reference / Target / Study Population
</div>
</div>
<div class="callout-body-container callout-body">
<p>Group we are interested in</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>Group we have data about</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Parameter
</div>
</div>
<div class="callout-body-container callout-body">
<p>Numeric summary of population</p>
<p>E.g.: <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(p\)</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Statistic
</div>
</div>
<div class="callout-body-container callout-body">
<p>Numeric summary of sample</p>
<p>E.g. <span class="math inline">\(\bar{X}\)</span>, <span class="math inline">\(s^2\)</span>, <span class="math inline">\(\hat{p}\)</span></p>
</div>
</div>
<ul>
<li><p>Simplest way to get a sample is by a simple random sample</p>
<ul>
<li>Each unit has an equal chance of being in sample</li>
</ul></li>
<li><p>Random selection (e.g., via SRS) is distinct from Random Assignment.</p></li>
<li><p>Random assignment: randomly assign units to different groups (e.g., treatment vs.&nbsp;control)</p></li>
<li><p>Random selection: results generalizable to target population</p>
<ul>
<li>Because sample is similar to population in terms of demographic variables</li>
</ul></li>
<li><p>Random assignment: allows for claims of causality</p>
<ul>
<li>Because all possible confounders are equal (on average) in the groups</li>
</ul></li>
<li><p>Randomized Clinical Trial (RCT): Random assignment of treatments to compare them.</p></li>
<li><p>No causal claims without random assignment</p></li>
<li><p>Example: tobramycin and gentamicin are antibiotics.</p>
<ul>
<li>Tobramycin is more aggressive and has more side effects.<br>
</li>
<li>Early studies were not randomized and showed tobramycin performed worse. Why?
<ul>
<li>Doctors gave sicker patients tobramycin</li>
</ul></li>
<li>Randomization guarantees equal number of sicker and less sick in each group (on average)</li>
</ul></li>
<li><p>Double blind: neither doctor nor patient know treatment</p>
<ul>
<li>Guards against placebo effect</li>
</ul></li>
<li><p>Single blind: doctor knows</p></li>
<li><p>Unblinded: both know</p></li>
</ul>
<hr>
<p><a href="../04_est/04_sample.html">Sampling in R</a></p>
<hr>
</section>
<section id="estimating-the-mean" class="level1">
<h1>Estimating the Mean</h1>
<ul>
<li>Suppose <span class="math inline">\(E(X_i) = \mu\)</span>
<ul>
<li>Not necessarily normal</li>
</ul></li>
<li>Estimate <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\hat{\mu} = \bar{X} = \frac{1}{n} \sum X_i\)</span>
<ul>
<li><span class="math inline">\(\hat{\mu}\)</span> is an estimate of <span class="math inline">\(\mu\)</span><br>
</li>
<li><span class="math inline">\(\bar{X}\)</span> is the sample mean</li>
<li>Often (almost always), <span class="math inline">\(\hat{\mu} = \bar{X}\)</span>.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Sampling distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Distribution of statistic across many (hypothetical) samples</p>
</div>
</div>
<p><img src="./04_figs/sampling_dist/sampling_dist.png" class="img-fluid">&nbsp;</p>
<ul>
<li><p>The sampling distribution is used to describe properties of statistics</p></li>
<li><p>Properties of <span class="math inline">\(\bar{X}\)</span></p>
<ul>
<li><p>Let <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span> be a random sample with<br>
<span class="math inline">\(E(X_i) = \mu\)</span>, <span class="math inline">\(\operatorname{Var}(X_i) = \sigma^2\)</span></p></li>
<li><p>Then:</p>
<ol type="1">
<li><span class="math inline">\(E(\bar{X}) = \mu\)</span> (unbiased)</li>
<li><span class="math inline">\(\operatorname{Var}(\bar{X}) = \sigma^2/n\)</span>
<ul>
<li>More precise for larger <span class="math inline">\(n\)</span> (consistent)</li>
</ul></li>
<li><span class="math inline">\(\bar{X} \approx N(\mu, \sigma^2/n)\)</span> for large <span class="math inline">\(n\)</span>, even if <span class="math inline">\(X_i\)</span> are not also normal
<ul>
<li>(Central Limit Theorem)</li>
</ul></li>
</ol></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Standard error
</div>
</div>
<div class="callout-body-container callout-body">
<p>Standard deviation of a statistic (its sampling distribution).</p>
</div>
</div>
<ul>
<li><span class="math inline">\(\operatorname{SE}(\bar{X}) = \sigma / \sqrt{n}\)</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Estimated Standard Error:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimated standard deviation of a statistic</p>
</div>
</div>
<ul>
<li><p>Most of the time, when folks say “standard error”, they mean estimated standard error.</p>
<ul>
<li>The book does this too.</li>
</ul></li>
<li><p><span class="math inline">\(\operatorname{SE}(\bar{X}) = s / \sqrt{n}\)</span></p></li>
<li><p>Typically don’t know <span class="math inline">\(\sigma^2\)</span>, so estimate it with <span class="math inline">\(s^2\)</span></p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 17%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Statistic</th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(\bar{X}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td>Variance</td>
<td><span class="math inline">\(\sigma^2\)</span></td>
<td><span class="math inline">\(\sigma^2 / n\)</span></td>
</tr>
<tr class="odd">
<td>Estimated Variance</td>
<td><span class="math inline">\(s^2\)</span></td>
<td><span class="math inline">\(s^2 / n\)</span></td>
</tr>
<tr class="even">
<td>Distribution</td>
<td>Unknown</td>
<td><span class="math inline">\(N(\mu, \sigma^2 / n)\)</span> (for large <span class="math inline">\(n\)</span>)</td>
</tr>
</tbody>
</table>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Exercise:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Mean birthweight is 112 oz with standard deviation 20.6. What is the probability the mean of 10 birthweights will be between 98 and 126?</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The distribution of <span class="math inline">\(\bar{X}\)</span> is: <span class="math display">\[
\bar{X} \sim N\left(112, \left(\frac{20.6}{\sqrt{10}}\right)^2\right) = N(112, 6.514^2)
\]</span></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The distribution of <span class="math inline">\(\bar{X}\)</span> is: <span class="math display">\[
\bar{X} \sim N\left(112, \left(\frac{20.6}{\sqrt{10}}\right)^2\right) = N(112, 6.514^2)
\]</span></p>
<p>We want the area between 98 and 126</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Which is the area to the left of 126</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Minus the area to the left of 98</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>We can calculate this in R:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">126</span>, <span class="at">mean =</span> <span class="dv">112</span>, <span class="at">sd =</span> <span class="fl">6.514</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">98</span>, <span class="at">mean =</span> <span class="dv">112</span>, <span class="at">sd =</span> <span class="fl">6.514</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9684</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interval-estimation" class="level1">
<h1>Interval Estimation</h1>
<ul>
<li><span class="math inline">\(\bar{X}\)</span> is not exactly equal to <span class="math inline">\(\mu\)</span></li>
<li>We want range of likely values of <span class="math inline">\(\mu\)</span></li>
<li>We know <span class="math inline">\(\bar{X} \sim N(\mu, \sigma^2 / n)\)</span> for large <span class="math inline">\(n\)</span></li>
</ul>
<p><span class="math display">\[\begin{align}
&amp;\Pr\left(-1.96 \leq \frac{\bar{X} - \mu}{\sigma / \sqrt{n}} \leq 1.96\right) \approx 0.95\\
&amp;\Leftrightarrow \Pr\left(-1.96 \cdot \frac{\sigma}{\sqrt{n}} \leq \bar{X} - \mu \leq 1.96 \cdot \frac{\sigma}{\sqrt{n}}\right) \approx 0.95\\
&amp;\Leftrightarrow \Pr(\bar{X} - 1.96 \cdot \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X} + 1.96 \cdot \frac{\sigma}{\sqrt{n}}) \approx 0.95
\end{align}\]</span></p>
<ul>
<li>Thus, <span class="math inline">\(\bar{X} \pm 1.96 \cdot \frac{\sigma}{\sqrt{n}}\)</span> captures <span class="math inline">\(\mu\)</span> with probability 0.95.
<ul>
<li>This is a 95% Confidence Interval (CI)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Common CI Format
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimate ± multiplier × standard error</p>
</div>
</div>
<ul>
<li>More generally, a <span class="math inline">\((1 - \alpha) \cdot 100\%\)</span> CI for <span class="math inline">\(\mu\)</span></li>
</ul>
<p><span class="math display">\[
  \bar{X} \pm \texttt{qnorm}(1 - \frac{\alpha}{2}) \cdot \frac{\sigma}{\sqrt{n}}
  \]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>CI Interpretation:</p>
<p><img src="./04_figs/ci_graphic.png" class="img-fluid">&nbsp;</p></li>
</ul>
<section id="when-variance-is-not-known" class="level2">
<h2 class="anchored" data-anchor-id="when-variance-is-not-known">When Variance is Not Known</h2>
<ul>
<li><p>The above only works when <span class="math inline">\(\sigma^2\)</span> is known</p>
<ul>
<li><span class="math inline">\(\sigma^2\)</span> is never known</li>
</ul></li>
<li><p><span class="math inline">\(\frac{\bar{X} - \mu}{s / \sqrt{n}} \sim t_{n-1}\)</span> (not <span class="math inline">\(N(0, 1)\)</span>)</p>
<ul>
<li><span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n - 1\)</span> degrees of freedom</li>
</ul></li>
<li><p>Only an exact result when <span class="math inline">\(X_1, \ldots, X_n \overset{\text{iid}}{\sim} N(\mu, \sigma^2)\)</span></p>
<ul>
<li>But <span class="math inline">\(t\)</span>-distribution tends to work better in small samples even when <span class="math inline">\(X_i\)</span> are not normal</li>
</ul></li>
<li><p>For large <span class="math inline">\(n\)</span>, <span class="math inline">\(t_{n-1} \approx N(0, 1)\)</span>, so CLT is OK</p></li>
<li><p>Bell-shaped, centered at 0</p></li>
<li><p>As <span class="math inline">\(\text{df} \downarrow\)</span>, extreme values more likely<br>
As <span class="math inline">\(\text{df} \uparrow\)</span>, extreme values less likely</p></li>
<li><p>Use <span class="math inline">\(t\)</span> because of added variability from using <span class="math inline">\(s^2\)</span> instead of <span class="math inline">\(\sigma^2\)</span></p></li>
</ul>
<hr>
<p><a href="../04_est/04_t.html">R Code for t-distribution</a></p>
<hr>
<ul>
<li>Rosner uses notation <span class="math inline">\(t_{\text{df}, p}\)</span> for the <span class="math inline">\(p\)</span> quantile of a <span class="math inline">\(t_{\text{df}}\)</span> distribution</li>
</ul>
<p><span class="math display">\[
t_{\text{df}, p} = \texttt{qt(p, df)}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[\begin{align}
&amp;\Pr\left(-t_{n-1, 1 - \alpha/2} \leq \frac{\bar{X} - \mu}{s/\sqrt{n}} \leq t_{n-1, 1 - \alpha/2} \right) = 1 - \alpha\\
&amp;\Leftrightarrow \Pr\left(-t_{n-1, 1 - \alpha/2} \cdot \frac{s}{\sqrt{n}} \leq \bar{X} - \mu \leq t_{n-1, 1 - \alpha/2} \cdot \frac{s}{\sqrt{n}} \right) = 1 - \alpha\\
&amp;\Leftrightarrow \Pr\left(\bar{X} - t_{n-1, 1 - \alpha/2} \cdot \frac{s}{\sqrt{n}} \leq \mu \leq \bar{X} + t_{n-1, 1 - \alpha/2} \cdot \frac{s}{\sqrt{n}} \right) = 1 - \alpha
\end{align}\]</span></p>
<ul>
<li>Thus, the following is a <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval for <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\sigma^2\)</span> is not known: <span class="math display">\[\begin{align}
&amp;\bar{X} \pm t_{n-1, 1 - \alpha/2} \cdot \frac{s}{\sqrt{n}} \text{ or, equivalently}\\
&amp;\bar{X} \pm \texttt{qt(1 - }\alpha/2\texttt{, n-1)} \cdot \frac{s}{\sqrt{n}}
\end{align}\]</span></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Suppose <span class="math inline">\(n = 10\)</span>, <span class="math inline">\(\bar{X} = 116.9\)</span>, <span class="math inline">\(s = 21.70\)</span>. Calculate 90%, 95%, 99% CIs</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The degrees of freedom of the appropriate <span class="math inline">\(t\)</span> distribution is <span class="math inline">\(10 - 1 = 9\)</span>.</p>
<p>E.g., for a 90% CI, <span class="math inline">\(\alpha = 1 - 0.9 = 0.1\)</span>, and you’ll need the <span class="math inline">\(1 - \alpha/2 = 1 - 0.1/2 = 0.95\)</span> quantile of that <span class="math inline">\(t\)</span> distribution.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Since <span class="math inline">\(n = 10\)</span>, the degrees of freedom of the appropriate <span class="math inline">\(t\)</span> distribution is <span class="math inline">\(10 - 1 = 9\)</span>., For 90% CI’s, <span class="math inline">\(\alpha = 0.1\)</span> and the appropriate quantile is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">9</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833</code></pre>
</div>
</div>
<p>We can thus get a 90% CI by</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">-</span> <span class="fl">1.833</span> <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">+</span> <span class="fl">1.833</span> <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 129.5</code></pre>
</div>
</div>
<p>Similarly, for a 95% CI we have</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">+</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 132.4</code></pre>
</div>
</div>
<p>And, for a 99% CI we have</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.01</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94.6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fl">116.9</span> <span class="sc">+</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.01</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">9</span>) <span class="sc">*</span> <span class="fl">21.70</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 139.2</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Note:
<ul>
<li>CI level <span class="math inline">\(\uparrow\)</span> (so <span class="math inline">\(\alpha \downarrow\)</span>) <span class="math inline">\(\Rightarrow\)</span> larger intervals</li>
<li><span class="math inline">\(n \uparrow\)</span> <span class="math inline">\(\Rightarrow\)</span> smaller intervals</li>
<li><span class="math inline">\(s^2 \uparrow\)</span> <span class="math inline">\(\Rightarrow\)</span> larger intervals</li>
</ul></li>
</ul>
<hr>
<p><a href="./http://localhost:3831/04_est/04_boneden.html">Bone Density Case Study</a></p>
<hr>
</section>
</section>
<section id="estimate-variance" class="level1">
<h1>Estimate Variance:</h1>
<ul>
<li><p>We estimate <span class="math inline">\(\sigma^2\)</span> with <span class="math inline">\(s^2 = \frac{1}{n - 1} \sum_{i=1}^n (X_i - \bar{X})^2\)</span></p></li>
<li><p>Why <span class="math inline">\(n - 1\)</span>?</p>
<p><span class="math display">\[
\bar{X} = \operatorname{argmin}_a \sum (X_i - a)^2
\]</span></p>
<p>The ideal estimate of <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(\frac{1}{n} \sum (X_i - \mu)^2\)</span>. However,</p>
<p><span class="math display">\[
\frac{1}{n} \sum (X_i - \bar{X})^2 \leq \frac{1}{n} \sum (X_i - \mu)^2
\]</span></p>
<p>So, <span class="math inline">\(\frac{1}{n} \sum (X_i - \bar{X})^2\)</span> is too small. Dividing by <span class="math inline">\(n-1\)</span> instead of <span class="math inline">\(n\)</span> makes it a little larger, and it turns out it makes it larger by the correct amount.</p></li>
<li><p>Property of the variance: <span class="math display">\[
\frac{s^2}{\sigma^2 / (n - 1)} \sim \chi^2_{n - 1}
\]</span></p></li>
<li><p>That is, the chi-squared distribution with <span class="math inline">\(n - 1\)</span> degrees of freedom.</p></li>
<li><p>This property <strong>only</strong> holds when the original data (<span class="math inline">\(X_1,X_2,\ldots,X_n\)</span>) or normally distributed.</p></li>
<li><p>Properties of chi-squared:</p>
<ol type="1">
<li>Support <span class="math inline">\(\geq 0\)</span></li>
<li><span class="math inline">\(E(\chi^2_{\text{df}}) = \text{df}\)</span></li>
<li>df <span class="math inline">\(\downarrow\)</span> <span class="math inline">\(\Rightarrow\)</span> thicker tails (extreme events happen more often)</li>
</ol></li>
<li><p>Can use this to get confidence intervals for <span class="math inline">\(\sigma^2\)</span> (<strong>only</strong> when your original data are normal).</p></li>
<li><p>Let <span class="math inline">\(\chi^2_{\text{df}, p}\)</span> = <span class="math inline">\(p^\text{th}\)</span> quantile of a <span class="math inline">\(\chi^2_{\text{df}}\)</span> distribution</p>
<ul>
<li><code>qchisq(p, df)</code></li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[\begin{align*}
&amp;\Pr\left( \chi^2_{n-1, \alpha/2} \leq \frac{s^2}{\sigma^2/(n-1)} \leq \chi^2_{n-1, 1-\alpha/2} \right) = 1 - \alpha\\
&amp;\Leftrightarrow  \Pr\left( \frac{(n - 1)s^2}{\chi^2_{n-1, 1 - \alpha/2}} \leq \sigma^2 \leq \frac{(n - 1)s^2}{\chi^2_{n-1, \alpha/2}} \right) = 1 - \alpha
\end{align*}\]</span></p>
<ul>
<li><p>Thus a <span class="math inline">\((1-\alpha)100\%\)</span> CI for the population variance (only when the original data are normally distributed) is: <span class="math display">\[
\frac{(n - 1)s^2}{\chi^2_{n-1, 1 - \alpha/2}} \leq \sigma^2 \leq \frac{(n - 1)s^2}{\chi^2_{n-1, \alpha/2}}
\]</span></p></li>
<li><p>Notes:</p>
<ul>
<li>Less often constructed than CI for <span class="math inline">\(\mu\)</span></li>
<li><strong>Very</strong> sensitive to violations of normality
<ul>
<li>CLT does not save you</li>
</ul></li>
<li>In real life, folks use a bootstrap if they want a CI for the variance.</li>
</ul></li>
</ul>
</section>
<section id="estimate-binomial-proportion" class="level1">
<h1>Estimate Binomial Proportion</h1>
<ul>
<li><p>Let <span class="math inline">\(X_1, X_2, \ldots, X_n\)</span> be independent Bernoulli trials s.t.:</p>
<p><span class="math display">\[
X_i =
\begin{cases}
1 &amp; \text{w.p. } p \\
0 &amp; \text{w.p. } 1 - p
\end{cases}
\]</span></p></li>
<li><p>Then <span class="math inline">\(X = \sum_{i=1}^n X_i\)</span> = number of 1’s out of <span class="math inline">\(n\)</span> trials<br>
</p></li>
<li><p><span class="math inline">\(X \sim \text{Bin}(n, p)\)</span></p></li>
<li><p>Example: Estimate prevalence of malignant melanoma</p>
<ul>
<li>Sample <span class="math inline">\(n = 5000\)</span> individuals.<br>
</li>
<li><span class="math inline">\(X_i = 1\)</span> if has melanoma, <span class="math inline">\(0\)</span> if no</li>
</ul></li>
<li><p>Goal: Observe <span class="math inline">\(X_i\)</span>, estimate <span class="math inline">\(p\)</span></p></li>
<li><p>We estimate <span class="math inline">\(p\)</span> with <span class="math display">\[
\hat{p} = \frac{1}{n} \sum X_i = \frac{X}{n} = \text{proportion of 1's}
\]</span></p></li>
<li><p>Properties:</p>
<ul>
<li><span class="math inline">\(E(\hat{p}) = E\left(\frac{X}{n}\right) = \frac{1}{n} E(X) = \frac{1}{n} n p = p \Rightarrow\)</span> unbiased</li>
<li><span class="math inline">\(\operatorname{Var}(\hat{p}) = \operatorname{Var}\left(\frac{X}{n}\right) = \frac{1}{n^2} \operatorname{Var}(X) = \frac{1}{n^2} n p(1 - p) = \frac{p(1 - p)}{n}\)</span>
<ul>
<li>More precise for larger <span class="math inline">\(n\)</span> <span class="math inline">\(\Rightarrow\)</span> consistent</li>
</ul></li>
</ul></li>
<li><p>Estimated standard error: <span class="math display">\[
\sqrt{ \frac{ \hat{p}(1 - \hat{p}) }{n} }
\]</span></p></li>
<li><p>Goal: Interval estimate of <span class="math inline">\(p\)</span></p></li>
<li><p>For large <span class="math inline">\(n\)</span>, <span class="math inline">\(\hat{p} \sim N\left(p,\ \frac{p(1 - p)}{n} \right)\)</span></p>
<ul>
<li>Rule of thumb: <span class="math inline">\(n \hat{p}(1 - \hat{p}) \geq 5\)</span></li>
</ul></li>
<li><p>Let <span class="math inline">\(z_p =\)</span> <code>qnorm(p)</code> <span class="math inline">\(= p^\text{th}\)</span> quantile of <span class="math inline">\(N(0, 1)\)</span></p></li>
<li><p>Then, subracting the mean from <span class="math inline">\(\hat{p}\)</span> and dividing by the estimated standard error, we have: <span class="math display">\[
\frac{ \hat{p} - p }{ \sqrt{ \frac{ \hat{p}(1 - \hat{p}) }{n} } } \approx N(0, 1)
\]</span></p></li>
<li><p>Thus: <span class="math display">\[
\Pr\left( z_{1 - \alpha/2} \leq \frac{ \hat{p} - p }{ \sqrt{ \hat{p}(1 - \hat{p}) / n } } \leq z_{\alpha/2} \right) \approx 1-\alpha
\]</span></p></li>
<li><p>Solving for <span class="math inline">\(p\)</span>, we get the following <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(p\)</span>: <span class="math display">\[
\hat{p} \pm z_{1 - \alpha/2} \cdot \sqrt{ \frac{ \hat{p}(1 - \hat{p}) }{n} }
\]</span></p></li>
<li><p>This follows the “Estimate <span class="math inline">\(\pm\)</span> Multiplier <span class="math inline">\(\times\)</span> Standard Error” format for a confidence interval.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Suppose out of 10,000 women, 400 have breast cancer. What is a 95% CI for breast cancer incidence?</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p><span class="math inline">\(n = 10000\)</span> and <span class="math inline">\(x = 400\)</span>. We need the <span class="math inline">\(1 - \alpha = 1 - 0.05 / 2 = 0.975\)</span> quantile of the standard normal.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Our estimated incidence is <span class="math inline">\(\hat{p} = 400 / 10000 = 0.04\)</span></p>
<p>Our estimated standard error is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fl">0.04</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.04</span>) <span class="sc">/</span> <span class="dv">10000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00196</code></pre>
</div>
</div>
<p>Checking for our rule of thumb: <span class="math inline">\(n \hat{p}(1 - \hat{p}) = 384 &gt; 5\)</span>, so we can use the CLT.</p>
<p>For a 95% confidence interval, <span class="math inline">\(\alpha = 0.05\)</span> and we need the <span class="math inline">\(1 - \alpha/2 = 1 - 0.05/2 = 0.975\)</span> quantile of the standard normal distribution, denoted <span class="math inline">\(z_{0.975}\)</span>, or</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.96</code></pre>
</div>
</div>
<p>Thus, our 95% confidence interval is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04</span> <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.00196</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03616</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04</span> <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">0.00196</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04384</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="exact-test" class="level3">
<h3 class="anchored" data-anchor-id="exact-test">Exact test</h3>
<ul>
<li><p>What if <span class="math inline">\(n\)</span> is small? Use an exact method</p></li>
<li><p>Find <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> such that: <span class="math display">\[\begin{align*}
\frac{\alpha}{2} &amp;= \text{pbinom}(x,\ \text{size} = n,\ \text{prob} = p_1)\\
\frac{\alpha}{2} &amp;= 1 - \text{pbinom}(x - 1,\ \text{size} = n,\ \text{prob} = p_2)
\end{align*}\]</span></p></li>
<li><p>E.g., <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(X = 3\)</span>. Suppose we want a 80% CI (so <span class="math inline">\(\alpha = 0.2\)</span>).</p></li>
<li><p>The value of <span class="math inline">\(p_1\)</span> such that the probability <span class="math inline">\(X\)</span> being at least <span class="math inline">\(3\)</span> equals <span class="math inline">\(\alpha/2=0.1\)</span> is 0.1158. Visually, the sum of the heights of the orange bars is 0.1:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>The value of <span class="math inline">\(p_1\)</span> such that the probability <span class="math inline">\(X\)</span> being at most <span class="math inline">\(3\)</span> equals <span class="math inline">\(\alpha/2=0.1\)</span> is 0.5517. Visually, the sum of the heights of the orange bars is 0.1:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="06_notes_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
</ul>
<hr>
<p><a href="./04_binom.html">Binomial R code</a></p>
<hr>
</section>
</section>
<section id="estimate-poisson-mean" class="level1">
<h1>Estimate Poisson Mean</h1>
<ul>
<li><p><span class="math inline">\(Y \sim \text{Poi}(\mu)\)</span> where <span class="math inline">\(\mu = \lambda T\)</span></p></li>
<li><p>Goal: Estimate <span class="math inline">\(\lambda\)</span></p>
<ul>
<li><span class="math inline">\(\lambda\)</span> = incidence rate per unit time<br>
</li>
<li><span class="math inline">\(T\)</span> = time</li>
</ul></li>
<li><p>Example: Leukemia rate in Woburn, MA.</p>
<ul>
<li>12,000 residents, 10 years, 12 children got leukemia</li>
</ul></li>
<li><p>A common unit in biostatistics is a <strong>person-year</strong></p>
<ul>
<li>1 person being followed for 1 year<br>
</li>
<li>Normalizes by number of people in a study<br>
</li>
<li>E.g., 12 cases out of 20 is a lot more than 12 out of 20000</li>
</ul></li>
<li><p>Example: Woburn study had 12,000 people × 10 years = 120,000 person-years</p></li>
<li><p>We estimate <span class="math inline">\(\lambda\)</span> with: <span class="math display">\[
\hat{\lambda} = \frac{X}{T}
\]</span></p></li>
<li><p><span class="math inline">\(T\)</span> can be in any unit of time. E.g., person-year.</p></li>
<li><p><span class="math inline">\(\hat{\lambda}\)</span> is unbiased: <span class="math display">\[
E(\hat{\lambda}) = E\left( \frac{X}{T} \right) = \frac{E(X)}{T} = \frac{\lambda T}{T} = \lambda \quad \text{(unbiased)}
\]</span></p></li>
<li><p>Woburn Example: <span class="math inline">\(\hat{\lambda} = \frac{12 \text{ cases}}{120{,}000 \text{ person-years}} = 0.0001 \text{ cases per person-year}\)</span></p></li>
<li><p>Cancer rates are typically low, so it is useful to multiply by 100,000 to get human-readable units</p></li>
<li><p>Woburn Example: <span class="math display">\[
0.0001 \text{ cases/person-year} = 10 \text{ cases / 100,000 person-years}
\]</span></p></li>
<li><p>Exact interval uses same strategy as exact binomial case:</p>
<ul>
<li>Find <span class="math inline">\(\mu_1\)</span> such that <span class="math inline">\(\Pr(X \geq x \mid \mu_1) = \alpha/2\)</span></li>
<li>Find <span class="math inline">\(\mu_2\)</span> such that <span class="math inline">\(\Pr(X \leq x \mid \mu_2) = \alpha/2\)</span></li>
<li>Interval: <span class="math inline">\((\mu_1,\ \mu_2)\)</span></li>
</ul></li>
<li><p>The interval for <span class="math inline">\(\lambda\)</span> is then: <span class="math display">\[
\left( \frac{\mu_1}{T},\ \frac{\mu_2}{T} \right)
\]</span></p></li>
<li><p>Use <code>poisson.test()</code> in R</p></li>
</ul>
</section>
<section id="one-sided-ci-if-we-have-time" class="level1">
<h1>One-sided CI (if we have time)</h1>
<ul>
<li><p>Suppose we are only interested in lower or upper bounds</p>
<ul>
<li>E.g., compare cancer treatment survival rate against baseline of 30%.<br>
Want lower bound on treatment effect to see if it’s better than baseline</li>
</ul></li>
<li><p>Find <span class="math inline">\(p_1\)</span> such that <span class="math inline">\(\Pr(p &gt; p_1) = 1 - \alpha\)</span></p>
<ul>
<li><span class="math inline">\(p_1\)</span> is the random variable and <span class="math inline">\(p\)</span> is the fixed parameter.</li>
</ul></li>
<li><p>Or, find <span class="math inline">\(p_2\)</span> such that <span class="math inline">\(\Pr(p &lt; p_2) = 1 - \alpha\)</span></p>
<ul>
<li>E.g., suppose we want an upper bound on the incidence rate of some treatment group</li>
</ul></li>
<li><p>Since <span class="math inline">\(\frac{\hat{p} - p}{\sqrt{ \hat{p}(1 - \hat{p}) / n }} \sim N(0, 1)\)</span>, we can get a one-sided confidence interval by knowing the following: <span class="math display">\[
\Pr\left(-z_{1 - \alpha} &lt; \frac{\hat{p} - p}{\sqrt{ \hat{p}(1 - \hat{p}) / n }} \right) = 1 - \alpha
\]</span> and solving for <span class="math inline">\(p\)</span>: <span class="math display">\[\begin{align*}
&amp;\Leftrightarrow \Pr\left(z_{1 - \alpha} &gt; \frac{p - \hat{p}}{\sqrt{ \hat{p}(1 - \hat{p}) / n }} \right) = 1 - \alpha\\
&amp;\Leftrightarrow \Pr\left(\hat{p} + z_{1 - \alpha} \cdot \sqrt{ \hat{p}(1 - \hat{p}) / n } &gt; p \right) = 1 - \alpha
\end{align*}\]</span> Thus, <span class="math inline">\(p_2\)</span> (the upper bound of a lower one sided confidence interval) is: <span class="math display">\[
p_2 = \hat{p} + z_{1 - \alpha} \cdot \sqrt{ \hat{p}(1 - \hat{p}) / n }
\]</span></p></li>
<li><p>Similarly, <span class="math inline">\(p_1\)</span> (the lower bound of an upper one-sided confidence interval) is: <span class="math display">\[
p_1 = \hat{p} - z_{1 - \alpha} \cdot \sqrt{ \hat{p}(1 - \hat{p}) / n }
\]</span></p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>40 out of 100 patients survive a new cancer treatment. What is the <strong>lower bound</strong> on <span class="math inline">\(\Pr(\text{survive})\)</span>? (Upper 1-sided 95% CI)</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Use the fact that <span class="math display">\[
\frac{\hat{p} - p}{\sqrt{\hat{p}(1-\hat{p})/n}} \approx N(0,1)
\]</span> for large <span class="math inline">\(n\)</span>.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>We have that <span class="math display">\[\begin{align*}
&amp;\Pr\left(\frac{\hat{p} - p}{\sqrt{\hat{p}(1-\hat{p})/n}} \leq z_{1-\alpha}\right) = 1-\alpha\\
&amp;\Leftrightarrow \Pr\left(\hat{p} - z_{1-\alpha} \sqrt{\hat{p}(1-\hat{p})/n} \leq p\right) = 1-\alpha
\end{align*}\]</span></p>
<p>Let’s find <span class="math inline">\(\hat{p}\)</span> <span class="math display">\[
\hat{p} = \frac{40}{100} = 0.4
\]</span></p>
<p>Let’s find <span class="math inline">\(z_{1-\alpha}\)</span> when <span class="math inline">\(\alpha = 0.05\)</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.645</code></pre>
</div>
</div>
<p>This gives us the following lower bound:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="sc">-</span> <span class="fl">1.645</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.4</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.4</span>) <span class="sc">/</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3194</code></pre>
</div>
</div>
<p>So the one-sided confidence interval is <span class="math inline">\(p &gt; 0.3194\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="exercises-6.5-6.10" class="level1">
<h1>Exercises 6.5 – 6.10</h1>
<p>The data in Table 6.10 concern the mean triceps skin-fold thickness in a group of normal men and a group of men with chronic airflow limitation <span class="citation" data-cites="arora1984effect">(<a href="#ref-arora1984effect" role="doc-biblioref">Arora and Rochester 1984</a>)</span>.</p>
<table class="caption-top table">
<caption>Table 6.10: Triceps skin-fold thickness in normal men and men with chronic airflow limitation</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Group</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Normal</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: right;">Chronic airflow limitation</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">32</td>
</tr>
</tbody>
</table>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Exercise 6.5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>What is the standard error of the mean for each group?</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<ul>
<li>Normal group: <span class="math inline">\(0.5 / \sqrt{40}\)</span> = 0.07906</li>
<li>Chronic airflow limitation group: <span class="math inline">\(0.4 / \sqrt{32}\)</span> = 0.07071</li>
</ul>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Exercise 6.6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Assume that the central-limit theorem is applicable. What does it mean in this context?</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>That the sample mean skin-fold thickness within each group is (approximately) normally distributed.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Exercise 6.7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Find the upper 1st percentile of a <span class="math inline">\(t\)</span> distribution with 16 df.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">df =</span> <span class="dv">16</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.583</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Exercise 6.8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Find the lower 10th percentile of a <span class="math inline">\(t\)</span> distribution with 28 df.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">df =</span> <span class="dv">28</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.313</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Exercise 6.9</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Find the upper 2.5th percentile of a <span class="math inline">\(t\)</span> distribution with 7 df.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.365</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Exercise 6.10</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>What are the upper and lower 2.5th percentiles for a chi-square distribution with 2 df? What notation is used to denote these percentiles?</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05064 7.37776</code></pre>
</div>
</div>
<p><span class="math display">\[
\chi^2_{2,0.025} \text{ and } \chi^2_{2,0.975}
\]</span></p>
</div>
</div>
</div>
</section>
<section id="exercises-6.11-6.17" class="level1">
<h1>Exercises 6.11 – 6.17</h1>
<p>Consider the hospital data that you can download from <a href="https://dcgerard.github.io/stat_320/data/hospital.csv">here</a> and read about <a href="https://dcgerard.github.io/stat_320/data.html#hospital">here</a>. Regard this hospital as typical of Pennsylvania hospitals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Exercise 6.11</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Solution by Hand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">Solution in R</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Compute a 95% CI for the mean age.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>The CI is: <span class="math display">\[
\bar{x} \pm t_{n - 1, 1 - 0.05/2}s/\sqrt{n}
\]</span> Let’s calculate these elements</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>hospital <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://dcgerard.github.io/stat_320/data/hospital.csv"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>hospital <span class="sc">|&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xbar =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(Age),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
   xbar     s     n     t
  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1  41.2  20.1    25  2.06</code></pre>
</div>
</div>
<p>So the CI is <span class="math display">\[
41.24 \pm 2.064 \times 20.1 / \sqrt{25}
\]</span></p>
<p>Plugging in R, we get:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.24</span> <span class="sc">-</span> <span class="fl">2.064</span> <span class="sc">*</span> <span class="fl">20.1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.24</span> <span class="sc">+</span> <span class="fl">2.064</span> <span class="sc">*</span> <span class="fl">20.1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32.94 49.54</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Age <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> hospital) <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     32.9      49.5</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">Exercise 6.12</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">Solution by Hand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">Solution in R</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Compute a 95% CI for the mean white blood count following admission.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>The CI is again <span class="math display">\[
\bar{x} \pm t_{n - 1, 1 - 0.05/2}s/\sqrt{n}
\]</span></p>
<p>Calculating these summaries, we get</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>hospital <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xbar =</span> <span class="fu">mean</span>(WBC),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">s =</span> <span class="fu">sd</span>(WBC),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
   xbar     s     n     t
  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1  7.84  3.21    25  2.06</code></pre>
</div>
</div>
<p>So the CI is <span class="math display">\[
7.84 \pm 2.064 \times 3.21 / \sqrt{25}
\]</span></p>
<p>Plugging in R, we get:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">7.84</span> <span class="sc">-</span> <span class="fl">2.064</span> <span class="sc">*</span> <span class="fl">3.21</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">7.84</span> <span class="sc">+</span> <span class="fl">2.064</span> <span class="sc">*</span> <span class="fl">3.21</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.515 9.165</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(WBC <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> hospital) <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     6.51      9.17</code></pre>
</div>
</div>
<p>You might think that since we have counts, you could try to assume that <span class="math inline">\(X_i \sim \mathrm{Poi}(\mu)\)</span> and try to come up with an exact confidence interval based on this assumption. This could be done by calculating <span class="math inline">\(X = \sum_{i=1}^n X_i\)</span>, which follows a Poisson with mean parameter <span class="math inline">\(n\mu\)</span>. You can get an exact CI for <span class="math inline">\(n\mu\)</span> and divide it by <span class="math inline">\(n\)</span> to get an exact CI for <span class="math inline">\(\mu\)</span>. But, the normal approximation would be appropriate for this approach anyway. More importantly, the <span class="math inline">\(t\)</span>-method is probably better anyway because it allows for over/underdispersion. Anyway, for comparison, this approach would result in:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sum</span>(hospital<span class="sc">$</span>WBC)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high) <span class="sc">|&gt;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">conf.low =</span> conf.low <span class="sc">/</span> <span class="dv">25</span>, <span class="at">conf.high =</span> conf.high <span class="sc">/</span> <span class="dv">25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     6.78      9.02</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Exercise 6.13</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Answer Problem 6.12 for a 90% CI.</p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>For the by-hand way, we just use the 0.95 quantile of the <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="dv">25</span> <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.711</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">7.84</span> <span class="sc">-</span> <span class="fl">1.711</span> <span class="sc">*</span> <span class="fl">3.21</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">7.84</span> <span class="sc">+</span> <span class="fl">1.711</span> <span class="sc">*</span> <span class="fl">3.21</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">25</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.742 8.938</code></pre>
</div>
</div>
<p>For the R way, we change the <code>conf.level</code> argument</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(WBC <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> hospital, <span class="at">conf.level =</span> <span class="fl">0.9</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     6.74      8.94</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">Exercise 6.14</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>What is the relationship between your answers to Problems 6.12 and 6.13?</p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>The CI in 6.12 is larger than the CI in 6.13 because it has a higher confidence level (you need wider intervals to capture the parameter more often).</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">Exercise 6.15</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>What is the best point estimate of the percentage of males among patients discharged from Pennsylvania hospitals?</p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>This is <span class="math inline">\(\hat{p}\)</span>, the proportion of patients that are male:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>hospital <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">x =</span> <span class="fu">sum</span>(Sex <span class="sc">==</span> <span class="st">"male"</span>), <span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      x     n
  &lt;int&gt; &lt;int&gt;
1    11    25</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(\hat{p} = 11 / 25 = 0.44\)</span>, 44% is the best estimate.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">Exercise 6.16</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>What is the standard error of the estimate obtained in Problem 6.15?</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>This is <span class="math inline">\(\sqrt{\hat{p}(1-\hat{p})/n} = \sqrt{0.44 * (1 - 0.44) / 25}\)</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fl">0.44</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.44</span>) <span class="sc">/</span> <span class="dv">25</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09928</code></pre>
</div>
</div>
<p>This is the standard error for <span class="math inline">\(\hat{p}\)</span>. If you really want to keep it in in units of percent (instead of proportions), then standard error is 9.928%.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Exercise 6.17</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Solution by Hand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">Solution in R</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>Provide a 95% CI for the percentage of males among patients discharged from Pennsylvania hospitals.</p>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>If we want to keep things in terms of proportions, we havee <span class="math display">\[
\hat{p} \pm z_{1-0.5/2} \times\sqrt{\hat{p}(1-\hat{p})/n}
\]</span></p>
<p>If we really want to keep things in terms of percent, then this is</p>
<p><span class="math display">\[
100 \times \hat{p} \pm z_{1-0.5/2}\times 100 \times\sqrt{\hat{p}(1-\hat{p})/n}
\]</span> That normal quantile <span class="math inline">\(z_{1-0.05/2}\)</span> is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.96</code></pre>
</div>
</div>
<p>So, we have</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">44</span> <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">9.928</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">44</span> <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fl">9.928</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.54 63.46</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">11</span>, <span class="at">n =</span> <span class="dv">25</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high) <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">conf.low =</span> <span class="dv">100</span> <span class="sc">*</span> conf.low, <span class="at">conf.high =</span> <span class="dv">100</span> <span class="sc">*</span> conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     24.4      65.1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercises-6.77-6.80" class="level1">
<h1>Exercises 6.77 – 6.80</h1>
<p>The value of mammography as a screening test for breast cancer has been controversial, particularly among young women. A study was recently performed looking at the rate of false positives for repeated screening mammograms among approximately 10,000 women who were members of Harvard Pilgrim Health Care, a large health-maintenance organization in New England <span class="citation" data-cites="elmore1998ten">(<a href="#ref-elmore1998ten" role="doc-biblioref">Elmore et al. 1998</a>)</span>. The study reported that of a total of 1996 tests given to 40- to 49-year-old women, 156 yielded false-positive results.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">Exercise 6.77</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>What does a false-positive test result mean, in words, in this context?</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<p>The mammogram result is positive (indicating breast cancer), but the woman does not have breast cancer.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">Exercise 6.78</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>Some physicians feel a mammogram is not cost effective unless one can be reasonably certain (e.g., 95% certain) that the false-positive rate is less than 10%. Can you address this issue based on the preceding data? (Hint: Use a CI approach.)</p>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p>We will create a 95% lower confidence interval. If the upper bound of this is less than 0.1, then we can be reasonably certain (at the 0.05 significance level) that the test is cost effective.</p>
<p>The lower one-sided CI has an upper bound of</p>
<p><span class="math display">\[
\hat{p} + z_{1 - \alpha} \sqrt{\hat{p}(1 - \hat{p})/n}
\]</span></p>
<p>Calculating values we get</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="dv">156</span> <span class="sc">/</span> <span class="dv">1996</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>phat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07816</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>z</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.645</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1996</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>So the upper bound is <span class="math display">\[
0.07816 + 1.645 \times \sqrt{0.07816(1 - 0.07816) / 1996}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.07816</span> <span class="sc">+</span> <span class="fl">1.645</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.07816</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.07816</span>) <span class="sc">/</span> <span class="dv">1996</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08804</code></pre>
</div>
</div>
<p>Since this upper bound is less than 0.1, we are reasonably certain (at the 0.05 significance level) that the test is cost effective.</p>
<p>In R, the upper bound is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">156</span>, <span class="at">n =</span> <span class="dv">1996</span>, <span class="at">alternative =</span> <span class="st">"less"</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1        0    0.0888</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">Exercise 6.79</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p>Suppose a woman is given a mammogram every 2 years starting at age 40. What is the probability that she will have at least one false-positive test result among 5 screening tests during her forties? (Assume the repeated screening tests are independent.)</p>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>Let <span class="math inline">\(p\)</span> be the probability of a false positive. Let <span class="math inline">\(X\)</span> be the number of tests, out of 5, whihch is a false positive. Then <span class="math inline">\(X \sim \mathrm{Binomial}(5, p)\)</span>. We want <span class="math inline">\(\mathrm{P}(X \geq 1) = 1 - \mathrm{P}(X = 0)\)</span>. This is, using the binomial PMF, <span class="math display">\[
1 - (1 - p)^5.
\]</span></p>
<p>We can estimate this probability with <span class="math inline">\(\hat{p}\)</span> <span class="math display">\[
1 - (1 - \hat{p})^5.
\]</span></p>
<p>In R, this estimate is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="dv">156</span> <span class="sc">/</span> <span class="dv">1996</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> phat)<span class="sc">^</span><span class="dv">5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3343</code></pre>
</div>
</div>
<p>It is very important to note that 0.3343 is <em>not</em> the answer. It is an <em>estimate</em> of the probability of at least one false positive. It is not the probability of at least one false positive.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">Exercise 6.80</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>Provide a two-sided 95% CI for the probability estimate in Problem 6.79.</p>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>A 95% confidence interval for <span class="math inline">\(p\)</span> is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>bindf <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">156</span>, <span class="at">n =</span> <span class="dv">1996</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>bindf</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1   0.0668    0.0908</code></pre>
</div>
</div>
<p>So we just transform these bounds using the formula from part 6.79</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> bindf)<span class="sc">^</span><span class="dv">5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  conf.low conf.high
1   0.2921    0.3787</code></pre>
</div>
</div>
<p>So a 95% confidence interval for the probability that a woman will have at least one false positive in her forties is (0.2921, 0.3787).</p>
</div>
</div>
</div>
</section>
<section id="exercises-6.102-6.103" class="level1">
<h1>Exercises 6.102 – 6.103</h1>
<p>Injuries are common in football and may be related to a number of factors, including the type of playing surface, the number of years of playing experience, and whether any previous injury exists. A study of factors affecting injury among Canadian football players was recently reported <span class="citation" data-cites="hagel2003injury">(<a href="#ref-hagel2003injury" role="doc-biblioref">Hagel, Fick, and Meeuwisse 2003</a>)</span>. The rate of injury to the upper extremity (that is, shoulder to hand) on a dry field consisting of natural grass was 2.73 injuries per 1000 games. Assume this rate is known without error.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">Exercise 6.102</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<p>The study reported 45 injuries to the upper extremity on a dry field consisting of artificial turf over the course of 10,112 games. What procedure can be used to assess whether the risk of injury is different on artificial turf versus natural grass?</p>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<p>Let <span class="math inline">\(X\)</span> be the number of injuries to the upper extremity on turf. If it were the same as natural grass, then we would expect <span class="math display">\[
X \sim \mathrm{Poisson}(t\lambda) = \mathrm{Poisson}\left(\frac{2.73}{1000} \times 10112\right) = \mathrm{Poisson}(27.61)
\]</span> Suppose <span class="math inline">\(X \sim \mathrm{Poisson}(\mu)\)</span>. If this were chapter seven, we would run a hypothesis test of the null that <span class="math inline">\(\mu = 27.61\)</span> versus the alternative that <span class="math inline">\(\mu \neq 27.61\)</span>. But this is chapter 6, so we just calculate a 95% confidence interval and see that 27.61 is included in it.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">45</span>, <span class="at">r =</span> <span class="fl">27.61</span>) <span class="sc">|&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(conf.low, conf.high)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;
1     32.8      60.2</code></pre>
</div>
</div>
<p>The confidence interval does not include 27.61, so we have evidence (at the 0.05 significance level) that the two rates differ.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">Exercise 6.103</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">Solutions</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<p>Provide a 95% CI for the rate of injury to the upper extremity on artificial turf. (Hint: Use the Poisson distribution.) Express each rate as the number of injuries per 1000 games.</p>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<p>The time period in 1000 game increments for this study is 10112 / 1000 = 10.112. We can just plug this into <code>poisson.test()</code> using this time increment.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">45</span>, <span class="at">T =</span> <span class="fl">10.112</span>, <span class="at">r =</span> <span class="fl">2.73</span>) <span class="sc">|&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  estimate statistic p.value parameter conf.low conf.high method     alternative
     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
1     4.45        45 0.00215      10.1     3.25      5.95 Exact Poi… two.sided  </code></pre>
</div>
</div>
<p>The 95% CI is 3.246 to 5.955 injuries per 1000 games.</p>
<p>You could also use this CI, like in the previous question, and note that since it does not include 2.73, we have evidence (at the 0.05 significance level) that the injury rates differ between the two fields.</p>
</div>
</div>
</div>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-arora1984effect" class="csl-entry" role="listitem">
Arora, NS, and DF Rochester. 1984. <span>“Effect of Chronic Airflow Limitation (CAL) on Sternocleidomastoid Muscle Thickness.”</span> <em>Chest</em> 85 (6): 58S–59S. <a href="https://doi.org/10.1378/chest.85.6_Supplement.58S">https://doi.org/10.1378/chest.85.6_Supplement.58S</a>.
</div>
<div id="ref-elmore1998ten" class="csl-entry" role="listitem">
Elmore, Joann G, Mary B Barton, Victoria M Moceri, Sarah Polk, Philip J Arena, and Suzanne W Fletcher. 1998. <span>“Ten-Year Risk of False Positive Screening Mammograms and Clinical Breast Examinations.”</span> <em>New England Journal of Medicine</em> 338 (16): 1089–96. <a href="https://doi.org/10.1056/NEJM199804163381601">https://doi.org/10.1056/NEJM199804163381601</a>.
</div>
<div id="ref-hagel2003injury" class="csl-entry" role="listitem">
Hagel, Brent E, Gordon H Fick, and Willem H Meeuwisse. 2003. <span>“Injury Risk in Men’s Canada West University Football.”</span> <em>American Journal of Epidemiology</em> 157 (9): 825–33. <a href="https://doi.org/10.1093/aje/kwg050">https://doi.org/10.1093/aje/kwg050</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>