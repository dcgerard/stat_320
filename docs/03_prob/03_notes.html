<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Gerard">
<meta name="dcterms.date" content="2025-07-10">

<title>Chapter 3 Notes: Probability – Stat 320: Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6bdd2aebeb936dcddaa5f935a5de481c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-ccd81253fefb92e9cd3f9eb5b5d87b54.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-6bdd2aebeb936dcddaa5f935a5de481c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stat 320: Biostatistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exercises-3.53---3.59-of-rosner" id="toc-exercises-3.53---3.59-of-rosner" class="nav-link active" data-scroll-target="#exercises-3.53---3.59-of-rosner">Exercises 3.53 - 3.59 of Rosner</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 3 Notes: Probability</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Gerard </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<ul>
<li><p><strong>Sample Space</strong>: Set of all possible outcomes.</p></li>
<li><p><strong>Event</strong>: Any set of outcomes (subset of sample space).</p></li>
<li><p><strong>Probability of Event</strong>: Frequency of the event over a large number of trials.</p></li>
<li><p><strong>Example</strong>: Tuberculin skin test to detect tuberculosis</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Outcome</th>
<th>Prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Positive</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>Negative</td>
<td>0.7</td>
</tr>
<tr class="odd">
<td>Uncertain</td>
<td>0.2</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Sample Space</strong>: <span class="math inline">\(\{ \text{Positive}, \text{Negative}, \text{Uncertain} \}\)</span></p></li>
<li><p><strong>Possible Events</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Event</th>
<th>Prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\{ \text{Positive} \}\)</span></td>
<td>0.1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\{ \text{Negative} \}\)</span></td>
<td>0.7</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\{ \text{Uncertain} \}\)</span></td>
<td>0.2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\{ \text{Positive, Negative} \}\)</span></td>
<td>0.8</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\{ \text{Positive, Uncertain} \}\)</span></td>
<td>0.3</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\{ \text{Negative, Uncertain} \}\)</span></td>
<td>0.9</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\{ \text{Positive, Negative, Uncertain} \}\)</span></td>
<td>1</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Notation</strong>:</p>
<ul>
<li><span class="math inline">\(P(E) =\)</span> Probability of event <span class="math inline">\(E\)</span></li>
<li>E.g., if <span class="math inline">\(E = \{\text{Positive, Negative}\}\)</span>, then <span class="math inline">\(P(E) = 0.8\)</span></li>
</ul></li>
<li><p>Two events are <strong>mutually exclusive</strong> if they cannot both happen at the same time.</p></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p><span class="math inline">\(E_1 = \{\text{Positive, Negative}\}\)</span></p></li>
<li><p><span class="math inline">\(E_2 = \{\text{Uncertain}\}\)</span></p></li>
<li><p><span class="math inline">\(E_3 = \{\text{Negative, Uncertain}\}\)</span></p></li>
<li><p><span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> are mutually exclusive.</p></li>
<li><p><span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_3\)</span> can both happen if the outcome is “Negative.”</p></li>
<li><p><span class="math inline">\(E_2\)</span> and <span class="math inline">\(E_3\)</span> can both happen if the outcome is “Uncertain.”</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
“Or rule”
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> are mutually exclusive, then: <span class="math display">\[P(E_1 \cup E_2) = P(E_1) + P(E_2)\]</span></p>
</div>
</div>
<ul>
<li><p><span class="math inline">\(E_1 \cup E_2\)</span> = Either <span class="math inline">\(E_1\)</span> or <span class="math inline">\(E_2\)</span> or both occur.</p>
<ul>
<li>Read “<span class="math inline">\(E_1\)</span> or <span class="math inline">\(E_2\)</span>”.</li>
</ul></li>
<li><p>Mutually Exclusive Events:</p>
<ul>
<li>The big blob is the entire sample space.</li>
<li>Each event is a circle.</li>
<li>Area of shapes are proportional to probability of event.</li>
</ul>
<p><img src="./figs/me.png" class="img-fluid">&nbsp;</p></li>
<li><p>Non-mutually Exclusive Events:</p>
<p><img src="./figs/not_me.png" class="img-fluid">&nbsp;</p></li>
<li><p>The <strong>complement</strong> of <span class="math inline">\(A\)</span>, denoted <span class="math inline">\(\overline{A}\)</span>, is the event that <span class="math inline">\(A\)</span> does not occur.</p></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><span class="math inline">\(E_1 = \{\text{Positive, Negative}\}\)</span></li>
<li><span class="math inline">\(\overline{E_1} = \{\text{Uncertain}\}\)</span></li>
</ul></li>
<li><p><span class="math inline">\(P(\{\text{Sample Space}\}) = 1\)</span></p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Complement rule
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
P(\overline{A}) = 1 - P(A) \Rightarrow P(A) = 1 - P(\overline{A})
\]</span></p>
</div>
</div>
<p><img src="./figs/complement.png" class="img-fluid">&nbsp;</p>
<ul>
<li><strong>Example</strong>:
<ul>
<li><span class="math inline">\(P(\text{Uncertain}) = 1 - P(\{\text{Positive, Negative}\}) = 1 - 0.8 = 0.2\)</span></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
“And rule”
</div>
</div>
<div class="callout-body-container callout-body">
<p>Two events are <strong>independent</strong> if and only if <span class="math display">\[
    P(A \cap B) = P(A) \cdot P(B)
    \]</span></p>
</div>
</div>
<ul>
<li><p><span class="math inline">\(A \cap B\)</span> = <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> both occur.</p>
<ul>
<li>Read “<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>”</li>
</ul></li>
<li><p>Intersection:</p>
<p><img src="./figs/intersection.png" class="img-fluid">&nbsp;</p></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p><span class="math inline">\(P(\text{Mother DBP &gt; 90}) = P(A) = 0.1\)</span></p></li>
<li><p><span class="math inline">\(P(\text{Father DBP &gt; 90}) = P(B) = 0.2\)</span></p></li>
<li><p>If independent, <span class="math display">\[
P(A \cap B) = P(A)P(B) = 0.1 \cdot 0.2 = 0.02
\]</span></p></li>
</ul></li>
<li><p><strong>Why called “independent”?</strong></p>
<ul>
<li><span class="math inline">\(A\)</span> is 10% of sample space area.</li>
<li><span class="math inline">\(A\)</span> is 10% of <span class="math inline">\(B\)</span>’s area.</li>
<li><span class="math inline">\(B\)</span> becomes the sample space if it occurs, and we don’t know <span class="math inline">\(A\)</span>, so <span class="math inline">\(A\)</span> still has a 10% chance, even if we know <span class="math inline">\(B\)</span>.</li>
<li>Therefore, <span class="math inline">\(B\)</span> occurring or not occurring does not change the probability of <span class="math inline">\(A\)</span>.</li>
</ul></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><span class="math inline">\(A^+\)</span>: Doctor <span class="math inline">\(A\)</span> diagnoses <span class="math inline">\(+\)</span></li>
<li><span class="math inline">\(B^+\)</span>: Doctor <span class="math inline">\(B\)</span> diagnoses <span class="math inline">\(+\)</span></li>
<li><span class="math inline">\(P(A^+) = 0.1\)</span>, <span class="math inline">\(P(B^+) = 0.17\)</span>, <span class="math inline">\(P(A^+ \cap B^+) = 0.09\)</span></li>
<li>Are the events independent?</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li><span class="math inline">\(0.1 \cdot 0.17 = 0.017 \neq 0.09\)</span></li>
<li>Therefore, the events are <strong>not independent</strong>.</li>
</ul>
</div>
</div>
</div>
<ul>
<li>Events <span class="math inline">\(A_1, A_2, \dots, A_n\)</span> are <strong>mutually independent</strong> if <span class="math display">\[
P(A_1 \cap A_2 \cap \dots \cap A_n) = P(A_1) \times P(A_2) \times \cdots \times P(A_n) =  \prod_{i=1}^{n} P(A_i)
\]</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Addition Law of Probability
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[P(A \cup B) = P(A) + P(B) - P(A \cap B)\]</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>What is the probability that Doctor <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> diagnoses <span class="math inline">\(+\)</span>?</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><span class="math display">\[
P(A^+ \cup B^+) = 0.1 + 0.17 - 0.08 = 0.19
\]</span></p>
</div>
</div>
</div>
<ul>
<li><strong>Note</strong>: <span class="math inline">\(P(A \cap B) = 0\)</span> if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conditional Probability
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[P(A | B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
</div>
</div>
<ul>
<li>This represents the “probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>.”
<ul>
<li>We already know <span class="math inline">\(B\)</span> has occurred. Given this, what is the probability of <span class="math inline">\(A\)</span> occuring?</li>
<li>What proportion of <span class="math inline">\(B\)</span> is also <span class="math inline">\(A\)</span>?</li>
</ul></li>
<li>If <span class="math inline">\(A \perp B\)</span>, then <span class="math inline">\(P(A | B) = P(A)\)</span>.
<ul>
<li><p><span class="math inline">\(A \perp B\)</span> = <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent.</p></li>
<li><p><strong>Proof</strong>: <span class="math display">\[P(A | B) = \frac{P(A \cap B)}{P(B)} = \frac{P(A) \cdot P(B)}{P(B)} = P(A)\]</span></p></li>
</ul></li>
<li><strong>Relative Risk of <span class="math inline">\(B\)</span> given <span class="math inline">\(A\)</span></strong>: <span class="math display">\[\frac{P(B | A)}{P(B | \overline{A})}\]</span>
<ul>
<li>This is a measure of dependence between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.
<ul>
<li><span class="math inline">\(=\)</span> 1 <span class="math inline">\(\Rightarrow\)</span> Independent</li>
<li><span class="math inline">\(&lt;\)</span> 1 <span class="math inline">\(\Rightarrow B\)</span> less likely given <span class="math inline">\(A\)</span></li>
<li><span class="math inline">\(&gt;\)</span> 1 <span class="math inline">\(\Rightarrow B\)</span> more likely given <span class="math inline">\(A\)</span></li>
</ul></li>
</ul></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<ul>
<li>Suppose <span class="math inline">\(P(A^+) = 0.1\)</span>, <span class="math inline">\(P(B^+) = 0.17\)</span>, <span class="math inline">\(P(A^+ \cap B^+) = 0.08\)</span></li>
<li>What is <span class="math inline">\(P(A^+ | B^+)\)</span>?</li>
<li>What is <span class="math inline">\(P(B^+ | A^+)\)</span>?</li>
<li>What is <span class="math inline">\(P(A^- | B^+)\)</span>?</li>
<li>What is <span class="math inline">\(P(B^- | B^+)\)</span>?</li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>By the definition of conditional probability, we have <span class="math display">\[
P(A^+ | B^+) = \frac{P(A^+ \cap B^+)}{P(B^+)} = \frac{0.08}{0.17} = 0.4706.
\]</span> Similarly <span class="math display">\[
P(B^+ | A^+) = \frac{P(A^+ \cap B^+)}{P(A^+)} = \frac{0.08}{0.1} = 0.8.
\]</span></p>
<p>To calculate <span class="math inline">\(P(A^- | B^+)\)</span> and <span class="math inline">\(P(B^- | A^+)\)</span>, use the complement rule <span class="math display">\[
P(A^- | B^+) = 1 - P(A^+ | B^+) = 1 - 0.4706 = 0.5294
\]</span> <span class="math display">\[
P(B^- | A^+) = 1 - P(B^+ | A^+) = 1 - 0.8 = 0.2
\]</span></p>
</div>
</div>
</div>
<ul>
<li><strong>Note</strong>: In biostatistics, we typically write <span class="math inline">\(\overline{A^+}\)</span> as <span class="math inline">\(A^-\)</span>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Law of Total Probability
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
P(A) &amp;= P(A \cap B) + P(A \cap \overline{B})\\
     &amp;= P(A | B) P(B) + P(A | \overline{B}) P(\overline{B})
\end{align*}\]</span></p>
</div>
</div>
<ul>
<li><p>Visualization of Total Probability:</p>
<p><img src="./figs/lotp.png" class="img-fluid">&nbsp;</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<ul>
<li>Define:
<ul>
<li><span class="math inline">\(A = \{\text{Mammogram } +\}\)</span></li>
<li><span class="math inline">\(B = \{\text{Breast Cancer } +\}\)</span></li>
</ul></li>
<li>Given:
<ul>
<li><span class="math inline">\(P(B | \overline{A}) = 0.0002\)</span></li>
<li><span class="math inline">\(P(B | A) = 0.1\)</span></li>
<li><span class="math inline">\(P(A) = 0.07\)</span></li>
</ul></li>
<li>Question: What is <span class="math inline">\(P(B)\)</span>?</li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p><span class="math display">\[\begin{align*}
P(B) &amp;= P(B | \overline{A}) \cdot P(\overline{A}) + P(B | A) \cdot P(A)\\
&amp;= 0.0002 \cdot (1 - 0.07) + 0.1 \cdot 0.07\\
&amp;= 0.007186
\end{align*}\]</span></p>
</div>
</div>
</div>
<ul>
<li><p>More generally, if <span class="math inline">\(A_1, A_2, \dots, A_k\)</span> partition the sample space, then <span class="math display">\[P(B) = \sum_{i=1}^k P(B | A_i) \cdot P(A_i)\]</span></p>
<ul>
<li>Partition: They are all mutually exclusive and together they make up the entire sample space.</li>
</ul></li>
<li><p>Visualization of Law of Total Probability:</p>
<p><img src="./figs/lotp2.png" class="img-fluid">&nbsp;</p></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p>Let:</p>
<ul>
<li><span class="math inline">\(A_1 = \{\text{Age 60-64}\}\)</span></li>
<li><span class="math inline">\(A_2 = \{\text{Age 65-69}\}\)</span></li>
<li><span class="math inline">\(A_3 = \{\text{Age 70-74}\}\)</span></li>
<li><span class="math inline">\(A_4 = \{\text{Age 75+}\}\)</span></li>
<li><span class="math inline">\(B = \{\text{Cataract}\}\)</span></li>
</ul></li>
<li><p>Given probabilities:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(A_i\)</span></th>
<th><span class="math inline">\(P(A_i)\)</span></th>
<th><span class="math inline">\(P(B | A_i)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(A_1\)</span> (60-64)</td>
<td>0.45</td>
<td>0.024</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_2\)</span> (65-69)</td>
<td>0.28</td>
<td>0.46</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_3\)</span> (70-74)</td>
<td>0.20</td>
<td>0.88</td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_4\)</span> (75+)</td>
<td>0.07</td>
<td>0.53</td>
</tr>
</tbody>
</table></li>
<li><p>To calculate <span class="math inline">\(P(B)\)</span>: <span class="math display">\[\begin{align*}
P(B) &amp;= \sum_{i=1}^4 P(B | A_i) \cdot P(A_i)\\
     &amp;= 00.24 \times 0.45 + 0.46 \times 0.28 + 0.88 \times 0.20 + 0.53 \times 0.07
\end{align*}\]</span></p></li>
</ul></li>
<li><p><strong>Predictive Value Positive (PV+)</strong> (also called <strong>Precision</strong>): <span class="math display">\[
PV^+ = P(\text{disease | test+})
\]</span></p></li>
<li><p><strong>Predictive Value Negative (PV-)</strong>: <span class="math display">\[
PV^- = P(\text{no disease | test-})
\]</span></p></li>
<li><p><strong>Confusion Matrix</strong>:</p>
<table align="center" style="border:none; background:transparent; text-align:center;">
<tbody>
<tr>
<td style="border:none;" rowspan="2">
</td>
<td style="border:none;">
</td>
<td style="background:#bbeeee;" colspan="2">
<p><b>Test</b></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td style="background:#ccffff;">
<p>Test Positive <span class="math inline">\(T^+\)</span></p>
</td>
<td style="background:#aadddd;">
<p>Test Negative <span class="math inline">\(T^-\)</span></p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td rowspan="2">
<p><b>Truth</b></p>

</td>
<td style="background:#ffffcc;">
<p>Positive <span class="math inline">\(D^+\)</span></p>
</td>
<td style="background:#ccffcc;">
<p>True Positive (TP)</p>
</td>
<td style="background:#ffdddd;">
<p>False Negative (FN) <br> (Type II Error)</p>
</td>
<td style="background:#eeffee;">
<p>Sensitivity <br> (True Positive Rate, Recall, Power) <br> <span class="math inline">\(\frac{TP}{D^+}\)</span></p>
</td>
<td style="background:#ffeeee;">
<p>False Negative Rate <br> (Type II Error Rate) <br> <span class="math inline">\(\frac{FN}{D^+}\)</span></p>
</td>
</tr>
<tr>
<td style="background:#ddddaa;">
<p>Negative <span class="math inline">\(D^-\)</span></p>
</td>
<td style="background:#ffcccc;">
<p>False Positive (FP) <br> (Type I Error)</p>
</td>
<td style="background:#bbeebb;">
<p>True Negative (TN)</p>
</td>
<td style="background:#eedddd;">
<p>False Positive Rate <br> (Type I Error Rate) <br> <span class="math inline">\(\frac{FP}{D^-}\)</span></p>
</td>
<td style="background:#ddeedd;">
<p>Specificity <br>(True Negative Rate) <br> <span class="math inline">\(\frac{TN}{D^-}\)</span></p>
</td>
</tr>
<tr>
<td style="border:none;" rowspan="2">
</td>
<td style="border-top:double silver; border-right:double silver;">
<p>Prevalence <br> <span class="math inline">\(\frac{D^+}{D^+ + D^-}\)</span></p>
</td>
<td style="background:#eeffee;">
<p>Positive Predictive Value <br> (Precision) <br> <span class="math inline">\(PV^+ = \frac{TP}{T^+}\)</span></p>
</td>
<td style="background:#ffeeee;border-right:double silver;">
<p>False Omission Rate <br> <span class="math inline">\(\frac{FN}{T^-}\)</span></p>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td style="background:#eedddd;">
<p>False Discovery Rate <br> <span class="math inline">\(\frac{FP}{T^+}\)</span></p>
</td>
<td style="background:#ddeedd;">
<p>Negative Predictive Value <br> <span class="math inline">\(PV^- = \frac{TN}{T^-}\)</span></p>
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li>Let:
<ul>
<li><span class="math inline">\(A = \{\text{Mammogram } +\}\)</span></li>
<li><span class="math inline">\(B = \{\text{Breast Cancer } +\}\)</span></li>
</ul></li>
<li>Given:
<ul>
<li><span class="math inline">\(P(B | A) = 0.1\)</span></li>
<li><span class="math inline">\(P(B | \overline{A}) = 0.0002\)</span></li>
</ul></li>
<li>Calculate <span class="math inline">\(PV^+\)</span> and <span class="math inline">\(PV^-\)</span>:
<ul>
<li><span class="math inline">\(PV^+ = P(B | A) = 0.1\)</span></li>
<li><span class="math inline">\(PV^- = P(\overline{B} | \overline{A}) = 1 - P(B | \overline{A}) = 1 - 0.0002 = 0.9998\)</span></li>
</ul></li>
</ul></li>
<li><p><strong>Sensitivity</strong>: <span class="math display">\[\text{Sensitivity} = P(\text{test } + | \text{disease } +)\]</span></p>
<ul>
<li>Also called the <strong>True Positive Rate</strong>.</li>
</ul></li>
<li><p><strong>Specificity</strong>: <span class="math display">\[\text{Specificity} = P(\text{test } - | \text{disease } -)\]</span></p>
<ul>
<li>Also called the <strong>True Negative Rate</strong>.</li>
</ul></li>
<li><p><strong>Note</strong>: “Test” can also refer to other indicators, such as symptoms.</p></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p>90% of individuals with lung cancer are smokers.</p></li>
<li><p>30% of individuals without lung cancer are smokers.</p></li>
<li><p><strong>Question</strong>: What are the sensitivity and specificity of smoking as a screening test?</p>
<ul>
<li>Here, the “test” is positive if an individual is smoker and is negative if the individual is not a smoker.</li>
<li>Let:
<ul>
<li><span class="math inline">\(A = \{\text{smoker}\}\)</span></li>
<li><span class="math inline">\(B = \{\text{lung cancer}\}\)</span></li>
</ul></li>
<li><strong>Solution</strong>:
<ul>
<li>Sensitivity: <span class="math display">\[\text{Sensitivity} = P(A | B) = 0.9\]</span></li>
<li>Specificity: <span class="math display">\[\text{Specificity} = P(\overline{A} | \overline{B}) = 1 - P(A | \overline{B}) = 1 - 0.3 = 0.7\]</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bayes’ Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
P(B | A) = \frac{P(A | B) \cdot P(B)}{P(A)}
\]</span></p>
</div>
</div>
<ul>
<li><p><span class="math inline">\(P(B)\)</span> is the <strong>prior</strong> probability.</p></li>
<li><p><span class="math inline">\(P(B | A)\)</span> is the <strong>posterior</strong> probability.</p></li>
<li><p>Typically, <span class="math inline">\(P(A)\)</span> is obtained using the law of total probability: <span class="math display">\[
P(A) = P(A | B) P(B) + P(A | \overline{B}) P(\overline{B})
\]</span></p></li>
<li><p><strong>Motivation</strong>:</p>
<ul>
<li>To find <span class="math inline">\(P(\text{disease} | \text{test}+)\)</span> (i.e., <span class="math inline">\(PV^+\)</span>), you typically know:
<ul>
<li><span class="math inline">\(P(\text{test} + | \text{disease})\)</span> (Sensitivity)</li>
<li><span class="math inline">\(P(\text{test} - | \text{no disease})\)</span> (Specificity)</li>
</ul></li>
<li>Formula for <span class="math inline">\(PV^+\)</span>: <span class="math display">\[\begin{align*}
PV^+ &amp;= P(D^+|T^+)\\
&amp;= \frac{P(T^+|D^+)P(D^+)}{P(T^+)}\\
&amp;= \frac{P(T^+|D^+)P(D^+)}{P(T^+|D^+)P(D^+) + P(T^+|D^-)P(D^-)}\\
&amp;= \frac{\text{Sensitivity} \times X}{\text{Sensitivity} \times X + (1 - \text{Specificity}) \times (1 - X)}
\end{align*}\]</span> where <span class="math inline">\(X = P(B)\)</span> (prevalence of disease).</li>
</ul></li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p>84% of hypertensives and 23% of normotensives are classified as hypertensive by a machine.</p></li>
<li><p>Prevalence of hypertension is 20%.</p></li>
<li><p><strong>Question</strong>: What are <span class="math inline">\(PV^+\)</span> and <span class="math inline">\(PV^-\)</span>?</p></li>
<li><p><strong>Solution</strong>:</p>
<ul>
<li><p>Given:</p>
<ul>
<li><span class="math inline">\(A = \{\text{test} +\}\)</span></li>
<li><span class="math inline">\(B = \{\text{hypertensive}\}\)</span></li>
<li><span class="math inline">\(P(B) = 0.2 \Rightarrow P(\overline{B}) = 0.8\)</span></li>
<li><span class="math inline">\(P(A | B) = 0.84\)</span></li>
<li><span class="math inline">\(P(A | \overline{B}) = 0.23 \Rightarrow P(\overline{A} | \overline{B}) = 1 - 0.23 = 0.77\)</span></li>
</ul></li>
<li><p>First, calculate <span class="math inline">\(P(A)\)</span> using the law of total probability: <span class="math display">\[\begin{align*}
P(A) &amp;= P(A | B) P(B) + P(A | \overline{B}) P(\overline{B})\\
&amp;= (0.84 \cdot 0.2) + (0.23 \cdot 0.8)\\
&amp;= 0.352
\end{align*}\]</span></p>
<ul>
<li>Therefore, <span class="math inline">\(P(\overline{A}) = 1 - P(A) = 0.648\)</span></li>
</ul></li>
<li><p>Calculate <span class="math inline">\(PV^+\)</span>: <span class="math display">\[
PV^+ = P(B|A) = \frac{P(A | B) \cdot P(B)}{P(A)} = \frac{0.84 \cdot 0.2}{0.352} = 0.48
\]</span></p></li>
<li><p>Calculate <span class="math inline">\(PV^-\)</span>: <span class="math display">\[
PV^- = P(\overline{B} | \overline{A}) = \frac{P(\overline{A} | \overline{B}) \cdot P(\overline{B})}{P(\overline{A})} = \frac{0.77 \cdot 0.8}{0.648} = 0.95
\]</span></p></li>
</ul></li>
</ul></li>
<li><p><strong>Recall</strong>: Law of Total Probability may include more than 2 events. <span class="math display">\[P(A) = P(A | B_1) P(B_1) + P(A | B_2) P(B_2) + \dots + P(A | B_k) P(B_k)\]</span></p></li>
<li><p><strong>Prevalence</strong>: <span class="math display">\[\text{Prevalence} = P(\text{disease} +)\]</span></p>
<ul>
<li>Proportion of the population that has the disease.</li>
</ul></li>
<li><p><strong>Cumulative Incidence</strong>: <span class="math display">\[\text{Cumulative Incidence} = P(\text{will get disease | never had it})\]</span></p></li>
</ul>
<section id="exercises-3.53---3.59-of-rosner" class="level2">
<h2 class="anchored" data-anchor-id="exercises-3.53---3.59-of-rosner">Exercises 3.53 - 3.59 of Rosner</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Exercise 0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>The familial aggregation of respiratory disease is a well-established clinical phenomenon. However, whether this aggregation is due to genetic or environmental factors or both is somewhat controversial. An investigator wishes to study a particular environmental factor, namely the relationship of cigarette-smoking habits in the parents to the presence or absence of asthma in their oldest child age 5 to 9 years living in the household (referred to below as their offspring). Suppose the investigator finds that (1) if both the mother and father are current smokers, then the probability of their offspring having asthma is 0.15; (2) if the mother is a current smoker and the father is not, then the probability of their offspring having asthma is 0.13; (3) if the father is a current smoker and the mother is not, then the probability of their offspring having asthma is 0.05; and (4) if neither parent is a current smoker, then the probability of their offspring having asthma is 0.04.</p>
<p>Convert this word problem to mathematical notation amenable to analysis.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<ul>
<li><p>Define:</p>
<ul>
<li><span class="math inline">\(M^+ =\)</span> Mother smokes</li>
<li><span class="math inline">\(F^+ =\)</span> Father smokes</li>
<li><span class="math inline">\(O^+ =\)</span> Offspring has asthma</li>
</ul></li>
<li><p>Given probabilities:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scenario</th>
<th><span class="math inline">\(P(O^+ | \text{Scenario})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(M^+ \cap F^+\)</span></td>
<td>0.15</td>
</tr>
<tr class="even">
<td><span class="math inline">\(M^+ \cap F^-\)</span></td>
<td>0.13</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(M^- \cap F^+\)</span></td>
<td>0.05</td>
</tr>
<tr class="even">
<td><span class="math inline">\(M^- \cap F^-\)</span></td>
<td>0.04</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Exercise 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Suppose the smoking habits of the parents are independent and the probability that the mother is a current smoker is 0.4, whereas the probability that the father is a current smoker is 0.5. What is the probability that both the father and mother are current smokers?</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Use the “and” rule.</p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>We want to calculate <span class="math inline">\(P(M^+ \cap F^+)\)</span> given: <span class="math inline">\(P(M^+) = 0.4\)</span>, <span class="math inline">\(P(F^+) = 0.5\)</span>, <span class="math inline">\(M^+ \perp F^+\)</span> <span class="math display">\[
P(M^+ \cap F^+) = P(M^+) \cdot P(F^+) = 0.4 \cdot 0.5 = 0.2
\]</span></p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Exercise 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Consider the subgroup of families in which the mother is not a current smoker. What is the probability that the father is a current smoker among such families? How does this probability differ from that calculated in Problem 1?</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Use independence.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>We want to calculate <span class="math inline">\(P(F^+ | M^-)\)</span>. However, since <span class="math inline">\(M^+\)</span> and <span class="math inline">\(F^+\)</span> are independent, <span class="math inline">\(P(F^+ | M^-) = P(F^+) = 0.5\)</span>. This is just the probability that the father is a smoker, as opposed to part 1 where we calculated the probability that both father and mother are smokers.</p>
</div>
</div>
</div>
<p>Suppose, alternatively, that if the father is a current smoker, then the probability that the mother is a current smoker is 0.6; whereas if the father is not a current smoker, then the probability that the mother is a current smoker is 0.2. Also assume that statements 1, 2, 3, and 4 above hold.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Exercise 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>If the probability that the father is a current smoker is 0.5, what is the probability that the father is a current smoker and that the mother is not a current smoker?</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Use <span class="math inline">\(P(F^+ \cap M^-) = P(M^- | F^+) \cdot P(F^+)\)</span>.</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Converting the word problem to math notation, we have::</p>
<ul>
<li><p><span class="math inline">\(P(M^+ | F^+) = 0.6\)</span></p></li>
<li><p><span class="math inline">\(P(M^+ | F^-) = 0.2\)</span></p></li>
<li><p><span class="math inline">\(P(F^+) = 0.5\)</span></p></li>
<li><p>Our goal is to calculate <span class="math inline">\(P(F^+ \cap M^-)\)</span>.</p></li>
<li><p>By the complement rule, we have <span class="math inline">\(P(M^- | F^+) = 1 - 0.6\)</span>. Using this, we have:</p></li>
</ul>
<p><span class="math display">\[
P(F^+ \cap M^-) = P(M^- | F^+) \cdot P(F^+) = (1 - 0.6) \cdot 0.5 = 0.4 \cdot 0.5 = 0.2
\]</span></p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Exercise 4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Are the current smoking habits of the father and the mother independent? Why or why not?</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>What is <span class="math inline">\(P(M^+|F^+)\)</span>? What is <span class="math inline">\(P(M^+|F^-)\)</span>?</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>There are a couple ways to check this:</p>
<ul>
<li>See if <span class="math inline">\(P(M^+|F^+) = P(M^+|F^-) = P(M^+)\)</span> (value of <span class="math inline">\(F\)</span> does not matter). Any inequality here indicates non-independence.</li>
<li>See if <span class="math inline">\(P(M^+ \cap F^+) = P(M^+)P(F^+)\)</span>, or any other combination, such as <span class="math inline">\(P(M^- \cap F^+) = P(M^-)P(F^+)\)</span>. An inequality here indicates non-independence.</li>
</ul>
<p>The easiest way is just the first. We know that <span class="math inline">\(P(M^+|F^+) =  0.6 \neq 0.2 = P(M^+|F^-)\)</span>. So no, they are not independent.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Exercise 5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Under the assumptions made in Problems 3 and 4, find the unconditional probability that the offspring will have asthma.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Use the law of total probability. You’ll be using <span class="math inline">\(P(O^+ | M^+ \cap F^+)\)</span>, <span class="math inline">\(P(O^+ | M^+ \cap F^-)\)</span>, <span class="math inline">\(P(O^+ | M^- \cap F^+)\)</span>, <span class="math inline">\(P(O^+ | M^- \cap F^-)\)</span>, <span class="math inline">\(P(M^+ \cap F^+)\)</span>, <span class="math inline">\(P(M^+ \cap F^-)\)</span>, <span class="math inline">\(P(M^- \cap F^+)\)</span>, and <span class="math inline">\(P(M^- \cap F^-)\)</span>.</p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>We want to calculate <span class="math inline">\(P(O^+)\)</span>:</p>
<p>Using the law of total probability: <span class="math display">\[\begin{align*}
P(O^+) &amp;= P(O^+ | M^+ \cap F^+) P(M^+ \cap F^+) + P(O^+ | M^+ \cap F^-) P(M^+ \cap F^-)\\
&amp;+ P(O^+ | M^- \cap F^+) P(M^- \cap F^+) + P(O^+ | M^- \cap F^-) P(M^- \cap F^-)
\end{align*}\]</span></p>
<p>We were given:</p>
<ul>
<li><span class="math inline">\(P(O^+ | M^+ \cap F^+) = 0.15\)</span>,</li>
<li><span class="math inline">\(P(O^+ | M^+ \cap F^-) = 0.13\)</span>,</li>
<li><span class="math inline">\(P(O^+ | M^- \cap F^+) = 0.05\)</span>, and</li>
<li><span class="math inline">\(P(O^+ | M^- \cap F^-) = 0.04\)</span>,</li>
<li><span class="math inline">\(P(M^+|F^+) = 0.6\)</span></li>
<li><span class="math inline">\(P(M^+|F^-) = 0.2\)</span></li>
<li><span class="math inline">\(P(F^+) = 0.5\)</span></li>
</ul>
<p>We have</p>
<ul>
<li><span class="math inline">\(P(M^+ \cap F^+) = P(M^+|F^+)P(F^+) = 0.6 * 0.5 = 0.3\)</span></li>
<li><span class="math inline">\(P(M^+ \cap F^-) = P(M^+|F^-)P(F^+) = 0.2 * 0.5 = 0.1\)</span></li>
<li><span class="math inline">\(P(M^- \cap F^+) = P(M^-|F^+)P(F^+) = (1 - 0.6) * 0.5 = 0.2\)</span></li>
<li><span class="math inline">\(P(M^- \cap F^-) = P(M^-|F^-)P(F^+) = (1 - 0.2) * 0.5 = 0.4\)</span></li>
</ul>
<p>Substituting the values: <span class="math display">\[
P(O^+) = (0.15 \cdot 0.3) + (0.13 \cdot 0.1) + (0.05 \cdot 0.2) + (0.04 \cdot 0.4) = 0.084
\]</span></p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Exercise 6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Suppose a child has asthma. What is the posterior probability that the father is a current smoker?</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Use Bayes rule.</p>
<p>Also note that <span class="math inline">\(P(O^+ \cap F^+) = P(O^+ \cap F^+ \cap M^+) + P(O^+ \cap F^+ \cap M^-)\)</span>.</p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>We want to calculate <span class="math inline">\(P(F^+ | O^+)\)</span>. Using Bayes rule we have</p>
<p><span class="math display">\[
P(F^+ | O^+) = \frac{P(F^+ \cap O^+)}{P(O^+)}
\]</span> We already calculated <span class="math inline">\(P(O^+) = 0.084\)</span> from Exercise 5. The hard part is <span class="math inline">\(P(F^+ \cap O^+)\)</span>. But we can use the law of total probability to get that. <span class="math display">\[\begin{align*}
P(F^+ \cap O^+) &amp;= P(F^+ \cap O^+ \cap M^+) + P(F^+ \cap O^+ \cap M^-)\\
&amp;= P(O^+ | F^+ \cap M^+)P(F^+ \cap M^+) + P(O^+ | F^+ \cap M^-)P(F^+ \cap M^-)\\
&amp;= 0.15 \cdot 0.3 + 0.05 \cdot 0.2\\
&amp;= 0.055,
\end{align*}\]</span> where we used <span class="math inline">\(P(F^+ \cap M^+) = 0.3\)</span> and <span class="math inline">\(P(F^+ \cap M^-) = 0.2\)</span> from Exercise 5.</p>
<p>Substituting values we have <span class="math display">\[
P(F^+ | O^+) = \frac{0.055}{0.084} = 0.6548.
\]</span></p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Exercise 7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>What is the posterior probability that the mother is a current smoker if the child has asthma?</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Use the same strategy as in Exercise 6.</p>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>We want <span class="math inline">\(P(M^+ | O^+)\)</span>. Using Bayes rule we have <span class="math display">\[
P(M^+ | O^+) = \frac{P(O^+ \cap M^+)}{P(O^+)}
\]</span> We can use the exact same strategy as in Exercise 6.</p>
<p><span class="math display">\[\begin{align*}
P(M^+ \cap O^+) &amp;= P(F^+ \cap M^+ \cap O^+) + P(F^- \cap M^+ \cap O^+) \text{ (law of total probability)}\\
&amp;= P(O^+ | F^+ \cap M^+) P(F^+ \cap M^+) + P(O^+ | F^- \cap M^+) P(F^- \cap M^+) \text{ (conditional probability)}\\
&amp;= 0.15 \cdot 0.3 + 0.13 \cdot 0.1 \text{ (given/calculated previously)}\\
&amp;= 0.058
\end{align*}\]</span></p>
<p>Substituting in values we have <span class="math display">\[
P(M^+ | O^+) = \frac{0.058}{0.084} = 0.6905.
\]</span></p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>