<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Gerard">
<meta name="dcterms.date" content="2025-11-07">

<title>Chapter 7: One Sample Hypothesis Testing – Stat 320: Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0d4a9d19931feb4fee1ddab4b2489000.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stat 320: Biostatistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hypothesis-testing-overview" id="toc-hypothesis-testing-overview" class="nav-link active" data-scroll-target="#hypothesis-testing-overview">Hypothesis Testing Overview</a></li>
  <li><a href="#hypothesis-testing-for-the-mean" id="toc-hypothesis-testing-for-the-mean" class="nav-link" data-scroll-target="#hypothesis-testing-for-the-mean">Hypothesis Testing for the Mean</a>
  <ul class="collapse">
  <li><a href="#two-sided-tests-for-the-mean" id="toc-two-sided-tests-for-the-mean" class="nav-link" data-scroll-target="#two-sided-tests-for-the-mean">Two-sided Tests for the Mean</a></li>
  <li><a href="#confidence-intervals-and-hypothesis-tests" id="toc-confidence-intervals-and-hypothesis-tests" class="nav-link" data-scroll-target="#confidence-intervals-and-hypothesis-tests">Confidence intervals and hypothesis tests</a></li>
  </ul></li>
  <li><a href="#power-calculations" id="toc-power-calculations" class="nav-link" data-scroll-target="#power-calculations">Power Calculations</a></li>
  <li><a href="#sample-size-calculation" id="toc-sample-size-calculation" class="nav-link" data-scroll-target="#sample-size-calculation">Sample Size Calculation</a></li>
  <li><a href="#one-sample-inference-for-binomial" id="toc-one-sample-inference-for-binomial" class="nav-link" data-scroll-target="#one-sample-inference-for-binomial">One-Sample Inference for Binomial</a>
  <ul class="collapse">
  <li><a href="#exact-test" id="toc-exact-test" class="nav-link" data-scroll-target="#exact-test">Exact Test</a></li>
  </ul></li>
  <li><a href="#power-calculations-for-binomial-tests" id="toc-power-calculations-for-binomial-tests" class="nav-link" data-scroll-target="#power-calculations-for-binomial-tests">Power Calculations for Binomial Tests</a></li>
  <li><a href="#poisson-test" id="toc-poisson-test" class="nav-link" data-scroll-target="#poisson-test">Poisson Test</a></li>
  <li><a href="#exercises-7.17.8" id="toc-exercises-7.17.8" class="nav-link" data-scroll-target="#exercises-7.17.8">Exercises 7.1–7.8</a></li>
  <li><a href="#exercises-7.527.55" id="toc-exercises-7.527.55" class="nav-link" data-scroll-target="#exercises-7.527.55">Exercises 7.52–7.55</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 7: One Sample Hypothesis Testing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Gerard </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="hypothesis-testing-overview" class="level1">
<h1>Hypothesis Testing Overview</h1>
<ul>
<li>Two hypotheses
<ul>
<li><span class="math inline">\(H_0\)</span>: <strong>Null</strong>
<ul>
<li>Baseline, to be disproved<br>
</li>
</ul></li>
<li><span class="math inline">\(H_1\)</span>: <strong>Alternative</strong>
<ul>
<li>Opposite of null (contradicts <span class="math inline">\(H_0\)</span>)</li>
</ul></li>
</ul></li>
<li>Example: Want to test if low socioeconomic status (SES) mothers have babies with lower birthweight
<ul>
<li>Know: national average is 120 oz<br>
</li>
<li>For <span class="math inline">\(n = 10\)</span> low SES mothers, observe
<ul>
<li><span class="math inline">\(\bar{X} = 115\)</span> oz, <span class="math inline">\(S = 24\)</span> oz<br>
</li>
</ul></li>
<li>Let <span class="math inline">\(\mu\)</span> = average birthweight of low SES mothers
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = 120\)</span><br>
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &lt; 120\)</span></li>
</ul></li>
</ul></li>
<li>We use data (e.g., <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(s^2\)</span>) to make a decision (<span class="math inline">\(H_0\)</span> vs.&nbsp;<span class="math inline">\(H_1\)</span>)</li>
</ul>
<p><span class="math display">\[
\begin{array}{c|cc}
&amp; H_0 \text{ true} &amp; H_1 \text{ true} \\
\hline
\text{Fail to Reject } H_0 &amp; \text{True negative} &amp; \text{Type II error} \\
\text{Reject } H_0 &amp; \text{Type I error} &amp; \text{True positive} \\
\end{array}
\]</span></p>
<ul>
<li><p>Example: If the truth is <span class="math inline">\(\mu = 120\)</span> (<span class="math inline">\(H_0\)</span> is true) but we say <span class="math inline">\(\mu &lt; 120\)</span> (reject <span class="math inline">\(H_0\)</span>), this is a Type I error</p></li>
<li><p>Typically,</p>
<ul>
<li>Null Hypothesis: parameter = some value<br>
</li>
<li>Alternative Hypothesis: One of:
<ul>
<li>parameter ≠ value,</li>
<li>parameter &gt; value,</li>
<li>parameter &lt; value,</li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Type I error rate
</div>
</div>
<div class="callout-body-container callout-body">
<p>Probability of a Type I error <span class="math display">\[\begin{align*}
\Pr(\text{Reject } H_0 \mid H_0 \text{ True}) &amp;= \text{significance level} \\
&amp;= \alpha
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Type II error rate
</div>
</div>
<div class="callout-body-container callout-body">
<p>Probability of a Type II error<br>
<span class="math display">\[\begin{align*}
\Pr(\text{Fail to reject } H_0 \mid H_1 \text{ True}) &amp;= \beta
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Power
</div>
</div>
<div class="callout-body-container callout-body">
<p>Probability of correctly rejecting the null. <span class="math display">\[\begin{align*}
\Pr(\text{Reject } H_0 \mid H_1 \text{ True})
&amp;= 1 - \Pr(\text{Fail to reject } H_0 \mid H_1 \text{ True}) \\
&amp;= 1 - \beta
\end{align*}\]</span></p>
</div>
</div>
<ul>
<li>These probabilities are all in terms of <strong>repeated samples</strong>.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Solution:</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>There is a new pain relief drug for osteoarthritis (OA).</p>
<ul>
<li>50 OA patients take drug; measure <span class="math inline">\(X\)</span> = % decline in pain level.<br>
</li>
<li>Reported:
<ul>
<li>If <span class="math inline">\(X &gt; 0\)</span>: less pain</li>
<li>If <span class="math inline">\(X &lt; 0\)</span>: more pain<br>
</li>
</ul></li>
<li>We want to test if the drug is effective (average <span class="math inline">\(X &gt; 0\)</span>)</li>
</ul>
<ol type="1">
<li>What hypotheses are being tested?<br>
</li>
<li>What do Type I error, Type II error, and power mean?</li>
</ol>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li>Let <span class="math inline">\(\mu\)</span> = mean % decline in pain</li>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = 0\)</span></li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &gt; 0\)</span></li>
<li>Type I: Say drug reduces pain on average, but it does not<br>
</li>
<li>Type II: Say drug does not reduce pain when it does<br>
</li>
<li>Power: Probability we say it works when it truly works</li>
</ul>
</div>
</div>
</div>
<ul>
<li><p>The goal of a good test is to make both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> as small as possible</p></li>
<li><p>However, typically, as <span class="math inline">\(\alpha \downarrow\)</span>, <span class="math inline">\(\beta \uparrow\)</span> and as <span class="math inline">\(\beta \downarrow\)</span>, <span class="math inline">\(\alpha \uparrow\)</span>.</p>
<ul>
<li>These are conflicting criteria</li>
</ul></li>
<li><p>Common strategy: Fix <span class="math inline">\(\alpha = 0.05\)</span> (or similar), and use a test that has small <span class="math inline">\(\beta\)</span></p></li>
<li><p>All hypothesis testing asks: <strong>How weird is our data if <span class="math inline">\(H_0\)</span> were true?</strong></p></li>
</ul>
<p><img src="./05_figs/hypothesis_tests.png" class="img-fluid" alt="Visual of observed data versus hypothetical data under null with tail probability marked">&nbsp;</p>
<ul>
<li><p>If data are very weird, reject <span class="math inline">\(H_0\)</span></p></li>
<li><p>If data are not very weird, fail to reject <span class="math inline">\(H_0\)</span></p></li>
</ul>
</section>
<section id="hypothesis-testing-for-the-mean" class="level1">
<h1>Hypothesis Testing for the Mean</h1>
<ul>
<li><p>Back to our example:<br>
Let <span class="math inline">\(X_1, X_2, \ldots, X_n \overset{\text{iid}}{\sim} N(\mu, \sigma^2)\)</span></p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = \mu_0\)</span><br>
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &lt; \mu_0\)</span></li>
</ul></li>
<li><p>This is a <strong>one-sided test</strong> because the alternative is of the form <span class="math inline">\(&gt;\)</span> or <span class="math inline">\(&lt;\)</span><br>
(as opposed to <span class="math inline">\(\mu \ne \mu_0\)</span>)</p></li>
<li><p>Idea: Use the <span class="math inline">\(t\)</span>-statistic as a measure of weirdness <span class="math display">\[
t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}
\]</span></p></li>
<li><p>If <span class="math inline">\(\mu = \mu_0\)</span>, then <span class="math inline">\(t\)</span> should be close to 0, since <span class="math inline">\(\bar{X}\)</span> will be close to <span class="math inline">\(\mu_0\)</span></p></li>
<li><p>In fact, under <span class="math inline">\(H_0\)</span> (that is, <strong>only</strong> when <span class="math inline">\(H_0\)</span> is true): <span class="math display">\[
t \sim t_{n-1}
\]</span></p></li>
<li><p>So compare <span class="math inline">\(t\)</span> to a <span class="math inline">\(t_{n-1}\)</span> distribution</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(t &lt; a\)</span> (some critical value)<br>
</li>
<li>Since this provides evidence for <span class="math inline">\(H_1\)</span></li>
</ul></li>
<li><p>We want to fix Type I error at level <span class="math inline">\(\alpha\)</span>: <span class="math display">\[
\Pr(t &lt; a) = \alpha
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>So choose <span class="math inline">\(a = t_{n-1,\alpha} =\)</span> <code>qt(alpha, n-1)</code></p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>One-sided Test for Mean, Alternative Less
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = \mu_0\)</span><br>
<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &lt; \mu_0\)</span><br>
given <span class="math inline">\(\alpha\)</span> (significance level)</p>
<p>Let<br>
<span class="math display">\[
t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}
\]</span></p>
<p>Reject <span class="math inline">\(H_0\)</span> if<br>
<span class="math display">\[
t &lt; \texttt{qt}(\alpha, n-1)
\]</span></p>
<p>Fail to reject if<br>
<span class="math display">\[
t \ge \texttt{qt}(\alpha, n-1)
\]</span></p>
<p>The <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\texttt{pt}(t,n-1)
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Test Statistic
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>test statistic</strong> is a statistic which measures strength of evidence against <span class="math inline">\(H_0\)</span></p>
</div>
</div>
<ul>
<li>For example, the test statistic we used for <span class="math inline">\(H_0: \mu = \mu_0\)</span> is<br>
<span class="math display">\[
t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}
\]</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Critical Value
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>critical value</strong> is the value beyond which we reject <span class="math inline">\(H_0\)</span>.</p>
</div>
</div>
<ul>
<li>For example, the critical value we used in our mean test was <span class="math inline">\(\texttt{qt}(\alpha, n-1)\)</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Rejection Region
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Rejection region</strong>: values of data for which we reject <span class="math inline">\(H_0\)</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Acceptance Region
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Acceptance region</strong>: values of data for which we accept <span class="math inline">\(H_0\)</span></p>
</div>
</div>
<ul>
<li><p>Example: Let’s choose <span class="math inline">\(\alpha = 0.01\)</span> and run the test for the birthweight example <span class="math display">\[\begin{align*}
H_0\!:\ &amp;\mu = 120 \\
H_1\!:\ &amp;\mu &lt; 120 \\
\end{align*}\]</span> We observe: <span class="math display">\[
\bar{X} = 115,\quad s = 24,\quad n = 100
\]</span> Our test statistic is <span class="math display">\[
t = \frac{115 - 120}{24/\sqrt{100}} = -2.08 \\
\]</span> We compare that to the critical value, which is the 0.01 quantile of the <span class="math inline">\(t\)</span> distribution with 99 degrees of freedom.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.01</span>, <span class="at">df =</span> <span class="dv">99</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.365</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(-2.08 &gt; -2.36\)</span>, the data are not weird (at the 0.01 level), so we <strong>fail to reject</strong> <span class="math inline">\(H_0\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Note: When presenting results, <strong>don’t use the word “weird”</strong>. Say instead</p>
<blockquote class="blockquote">
<p>We fail to reject the null that mean birthweights are 120 oz at significance level 0.01.</p>
</blockquote></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>p-value
</div>
</div>
<div class="callout-body-container callout-body">
<p>The smallest <span class="math inline">\(\alpha\)</span> at which we would reject <span class="math inline">\(H_0\)</span></p>
<p>Equivalently, the probability we would see data as extreme or more extreme than what we saw.</p>
</div>
</div>
<ul>
<li><p>In the one-sided hypothesis test case, the <span class="math inline">\(p\)</span>-value is the probability of being to the left of the observed value.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">2.08</span>, <span class="dv">99</span>)  <span class="co"># Left-tailed p-value</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02005</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\text{p-value} &lt; \alpha \iff t &lt; t_{n-1,\alpha}
\]</span></p>
</div>
</div>
<ul>
<li><p>That is, we can reject either if the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(\alpha\)</span> <strong>or</strong> if the <span class="math inline">\(t\)</span>-statistic is less than the critical value.</p></li>
<li><p>Typically folks only report <span class="math inline">\(p\)</span>-values and not the <span class="math inline">\(t\)</span>-statistics.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Exercise:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<ul>
<li>Mean infarct size (size of dead tissue in heart) is 25 (ck-g-Q/m²)</li>
<li>8 patients treated with drug have average infarct size of 16 with SD = 10<br>
</li>
<li>Is drug effective in reducing infarct size?</li>
<li>Run a hypothesis test.</li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Our two hypotheses are</p>
<ul>
<li><span class="math inline">\(H_0: \mu = 25\)</span></li>
<li><span class="math inline">\(H_1: \mu &lt; 25\)</span></li>
</ul>
<p>We calculate the <span class="math inline">\(t\)</span>-statistic to be <span class="math display">\[
t = \frac{16 - 25}{10/\sqrt{8}} = -2.55
\]</span> Our <span class="math inline">\(p\)</span>-value is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="at">q =</span> <span class="sc">-</span><span class="fl">2.55</span>, <span class="at">df =</span> <span class="dv">7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01905</code></pre>
</div>
</div>
<p>We have significant results at the 0.05 level.</p>
</div>
</div>
</div>
<ul>
<li><p>Guidelines for <span class="math inline">\(p\)</span>-value interpretation:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Range</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0.05 \le p\)</span></td>
<td>not significant</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.01 \le p &lt; 0.05\)</span></td>
<td>significant</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.001 \le p &lt; 0.01\)</span></td>
<td>highly significant</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p &lt; 0.001\)</span></td>
<td>very highly significant</td>
</tr>
</tbody>
</table></li>
<li><p>Those interpretations are not dogma. Use them as rules of thumb. E.g. 0.051 is no different (practically speaking) than 0.049.</p></li>
<li><p>Or you can use the XKCD joke interpretations:</p>
<p><img src="https://imgs.xkcd.com/comics/p_values.png" alt="Joke of p-value interpretations"></p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\(p\)</span>-value tells you strength of evidence that there <strong>is</strong> an effect</p>
<p>It tells you <strong>nothing</strong> about the <strong>size</strong> of the effect</p>
</div>
</div>
<ul>
<li><p>Large sample size + tiny effect <span class="math inline">\(\Rightarrow\)</span> still small <span class="math inline">\(p\)</span>-value</p></li>
<li><p>Example: <span class="math display">\[\begin{align*}
n &amp;= 10{,}000 \\
\bar{X} &amp;= 119 \\
s &amp;= 24 \\
t &amp;= \frac{119 - 120}{24 / \sqrt{10{,}000}} = -4.17 \\
\end{align*}\]</span> So the <span class="math inline">\(p\)</span>-value is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">4.17</span>, <span class="dv">9999</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.536e-05</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(\Rightarrow\)</span> Very sure <span class="math inline">\(\mu &lt; 120\)</span>, but 119 is such a tiny difference from 120</li>
<li><span class="math inline">\(\Rightarrow\)</span> statistically significant, not practically significant</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>One-sided Test for Mean, Alternative Greater
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(X_1, X_2, \ldots, X_n \overset{\text{iid}}{\sim} N(\mu, \sigma^2)\)</span></p>
<p>Hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = \mu_0\)</span><br>
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &gt; \mu_0\)</span></li>
</ul>
<p>Test statistic:<br>
<span class="math display">\[
t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}
\]</span></p>
<p>The <span class="math inline">\(p\)</span>-value is the probability under <span class="math inline">\(H_0\)</span> of being greater than <span class="math inline">\(t\)</span><br>
<span class="math display">\[
\text{p-value} = 1 - \texttt{pt}(t,\ n-1)
\]</span></p>
<p>The critical value is the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(t_{n-1}\)</span> distribution. <span class="math display">\[
\texttt{qt}(1 - \alpha, n-1)
\]</span> Reject for <span class="math inline">\(t\)</span> larger than the critical value.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Exercise:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Mean cholesterol in the population is 175 mg/dL.</p>
<p>We have a sample 10 children of fathers who died from heart disease</p>
<p>We observe <span class="math inline">\(\bar{X} = 200\)</span>, <span class="math inline">\(s = 50\)</span></p>
<p>Is there evidence that these children have higher cholesterol?</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Our two hypotheses are</p>
<ul>
<li><span class="math inline">\(H_0 : \mu = 175\)</span></li>
<li><span class="math inline">\(H_1 : \mu &gt; 175\)</span></li>
</ul>
<p>We calculate our test statistic: <span class="math display">\[
t = \frac{200 - 175}{50 / \sqrt{10}} = 1.58 \\
\]</span></p>
<p>Our <span class="math inline">\(p\)</span>-value is then</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fl">1.58</span>, <span class="dv">9</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07428</code></pre>
</div>
</div>
<p>Therefore, we have weak evidence that they have higher cholesterol.</p>
</div>
</div>
</div>
<section id="two-sided-tests-for-the-mean" class="level2">
<h2 class="anchored" data-anchor-id="two-sided-tests-for-the-mean">Two-sided Tests for the Mean</h2>
<ul>
<li><p><del>Sometimes</del> Usually, our alternative is just that the mean is not equal to the null value.</p>
<ul>
<li>E.g., average birthweights for low SES families are different from the population average.</li>
</ul></li>
<li><p>What constitutes “more weird” in this case is the area in both tails.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="t-distribution showing two tailed p-value" width="384"></p>
</figure>
</div>
</div>
</div></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Two-tailed Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X_1, X_2, \ldots, X_n \overset{\text{iid}}{\sim} N(\mu, \sigma^2)\)</span></p>
<p>Hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = \mu_0\)</span><br>
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu \ne \mu_0\)</span></li>
</ul>
<p>Test statistic:<br>
<span class="math display">\[
t = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}
\]</span></p>
<p>Two-tailed p-value:<br>
<span class="math display">\[
\text{p-value} = 2 \cdot \texttt{pt}(-|t|,\ n-1)
\]</span></p>
<p>Critical value technique: Reject <span class="math inline">\(H_0\)</span> if<br>
<span class="math display">\[
|t| &gt; \texttt{qt}\left(1 - \frac{\alpha}{2},\ n-1\right)
\]</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Exercise:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Cholesterol levels of US women are 190 mg/dL on average.<br>
Want to compare cholesterol levels of recent Asian immigrants.<br>
100 female Asian immigrants:<br>
- <span class="math inline">\(\bar{X} = 181.52\)</span> mg/dL<br>
- <span class="math inline">\(s = 40\)</span> mg/dL</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p><span class="math display">\[\begin{align*}
H_0 &amp;: \mu = 190 \\
H_1 &amp;: \mu \ne 190 \\
t &amp;= \frac{181.52 - 190}{40 / \sqrt{100}} = -2.12 \\
\text{p-value} &amp;= 2 \cdot pt(-2.12,\ 99) \approx 0.037
\end{align*}\]</span></p>
</div>
</div>
</div>
<ul>
<li>Use <strong>two-sided tests by default</strong>, unless only one direction is clearly of interest
<ul>
<li>e.g., drug efficacy</li>
</ul></li>
<li>Because this is an introductory class, there will be a lot of one-sided tests, to evaluate your understanding. These are typically rare in practice.</li>
</ul>
<hr>
<p><a href="../05_tests/05_ttest.html">One-sample t-tests in R</a></p>
<hr>
</section>
<section id="confidence-intervals-and-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-and-hypothesis-tests">Confidence intervals and hypothesis tests</h2>
<p>Suppose <span class="math inline">\(X_1, X_2, \ldots, X_n \overset{\text{iid}}{\sim} N(\mu, \sigma^2)\)</span> and</p>
<ul>
<li><span class="math inline">\(H_0 : \mu = \mu_0\)</span></li>
<li><span class="math inline">\(H_1 : \mu \ne \mu_0\)</span></li>
</ul>
<p>Then, we reject <span class="math inline">\(H_0\)</span> at level <span class="math inline">\(\alpha\)</span> <strong>if and only if</strong> the <span class="math inline">\(100(1 - \alpha)\%\)</span> confidence interval <strong>does not contain</strong> <span class="math inline">\(\mu_0\)</span></p>
<ul>
<li><p>I.e., if <span class="math inline">\(\mu_0\)</span> is outside the <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval, then reject <span class="math inline">\(H_0\)</span> at level <span class="math inline">\(\alpha\)</span> and the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(\alpha\)</span></p></li>
<li><p>General result: All tests correspond to some confidence interval, and vice versa</p></li>
<li><p>So, a <span class="math inline">\(100(1 - \alpha)\%\)</span> CI contains all values of <span class="math inline">\(\mu_0\)</span> that would fail to reject <span class="math inline">\(H_0: \mu = \mu_0\)</span></p></li>
<li><p>One-sided confidence intervalss correspond to one-sided tests</p></li>
</ul>
</section>
</section>
<section id="power-calculations" class="level1">
<h1>Power Calculations</h1>
<ul>
<li><p>Power = Probability of correctly rejecting the null:<br>
<span class="math display">\[
\text{Power} = \Pr(\text{Reject } H_0 \mid H_1) = 1 - \beta
\]</span></p></li>
<li><p>In experiments/surveys, it is common to guess power prior to collecting data so that we can:</p>
<ol type="1">
<li>Calculate <span class="math inline">\(n\)</span> needed</li>
<li>See what effect sizes we can detect</li>
<li>See how likely our study will be successful</li>
</ol></li>
<li><p>To calculate power, you need four things:</p>
<ol type="1">
<li>Guess of effect size <span class="math inline">\(\mu_1 - \mu_0\)</span> (from pilot study or wild guess)</li>
<li>Guess of standard deviation <span class="math inline">\(\sigma\)</span> (from pilot study or wild guess)</li>
<li>Sample size <span class="math inline">\(n\)</span> (provided by researcher)</li>
<li>Significance level <span class="math inline">\(\alpha\)</span> (provided by researcher)</li>
</ol></li>
<li><p>If <span class="math inline">\(\sigma\)</span> is known, use <span class="math inline">\(z\)</span>-test instead of <span class="math inline">\(t\)</span>-test to calculate power</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>z-test, Alternative Less
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\(X_1,X_2,\ldots,X_n \sim N(\mu, \sigma^2)\)</span> where <span class="math inline">\(\sigma^2\)</span> is known, and we are considering the following hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0 : \mu = \mu_0\)</span></li>
<li><span class="math inline">\(H_1 : \mu &lt; \mu_0\)</span></li>
</ul>
<p>Then we calculate the <span class="math inline">\(z\)</span> statistic: <span class="math display">\[
z = \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}}
\]</span></p>
<p>The <span class="math inline">\(p\)</span>-value for this test is <code>qnorm(z)</code>.</p>
<p>The critical value for this test is <code>qnorm(α)</code> which is <span class="math inline">\(z_{\alpha}\)</span> in the Rosner notation. We reject if <span class="math inline">\(z &lt; z_{\alpha}\)</span>.</p>
</div>
</div>
<ul>
<li><p>Let’s calculate the power of the <span class="math inline">\(z\)</span> test when <span class="math inline">\(\mu = \mu_1\)</span>. <span class="math display">\[\begin{align*}
\Pr(\text{Reject } H_0 \mid \mu = \mu_1)
&amp;= \Pr\left( \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}} &lt; z_\alpha \ \Big| \ \mu = \mu_1 \right) \\
&amp;= \Pr\left( \frac{\bar{X} - \mu_1 + \mu_1 - \mu_0}{\sigma/\sqrt{n}} &lt; z_\alpha | \ \mu = \mu_1 \right)\\
&amp;= \Pr\left( \frac{\bar{X} - \mu_1}{\sigma/\sqrt{n}} - \frac{\mu_0 - \mu_1}{\sigma/\sqrt{n}}&lt; z_\alpha | \ \mu = \mu_1 \right) \\
&amp;= \Pr\left( \frac{\bar{X} - \mu_1}{\sigma/\sqrt{n}} &lt; \frac{\mu_0 - \mu_1}{\sigma/\sqrt{n}} + z_\alpha | \ \mu = \mu_1 \right) \\
&amp;= \Phi\left( \frac{\mu_0 - \mu_1}{\sigma/\sqrt{n}} + z_\alpha\right)
\end{align*}\]</span></p></li>
<li><p><span class="math inline">\(\Phi(\cdot)\)</span> is the CDF of the standard normal distribution</p></li>
<li><p>The final line follows since <span class="math inline">\(\frac{\bar{X} - \mu_1}{\sigma/\sqrt{n}}\)</span> follows <span class="math inline">\(N(0,1)\)</span> when <span class="math inline">\(\mu = \mu_1\)</span>.</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Power of z-test, Alternative Less
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\text{Power} = \Phi\left( z_\alpha + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma} \right)
\]</span></p>
</div>
</div>
<ul>
<li><p>This is what <span class="math inline">\(\phi()\)</span> looks like</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>So if the thing inside <span class="math inline">\(\Phi(\cdot)\)</span> gets larger, then power increases.</p>
<ul>
<li>E.g., if <span class="math inline">\(\alpha\)</span> increases, then <span class="math inline">\(z_{\alpha}\)</span> increases (higher quantile), and power increases.</li>
<li>If <span class="math inline">\(n\)</span> increases, then <span class="math inline">\(\sqrt{n}\)</span> increases, and power increases.</li>
<li>If <span class="math inline">\(\sigma\)</span> increases, then <span class="math inline">\(\frac{1}{\sigma}\)</span> decreases, so power decreases.</li>
</ul></li>
<li><p>Here’s a summary of how parameters affect power:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Change</th>
<th>Effect on Power</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>↓</td>
<td>Power ↓</td>
<td>More stringent test</td>
</tr>
<tr class="even">
<td><span class="math inline">\(n\)</span></td>
<td>↓</td>
<td>Power ↓</td>
<td>Less data</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(|\mu_0 - \mu_1|\)</span></td>
<td>↓</td>
<td>Power ↓</td>
<td>Smaller effect size</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma\)</span></td>
<td>↓</td>
<td>Power ↑</td>
<td>More precise measurements</td>
</tr>
</tbody>
</table></li>
</ul>
<p><img src="./05_figs/power_ztest.png" class="img-fluid" alt="overlapping normal curves showing the distribution of the sample mean under the null and the alternative, with the significance level and power labeled"></p>
<ul>
<li>Example: Pilot study using 10 individuals gave:
<ul>
<li><p><span class="math inline">\(\bar{X} = -5\)</span>, <span class="math inline">\(s = 10\)</span><br>
</p></li>
<li><p>Assume <span class="math inline">\(\mu = 0\)</span> is the null (no effect)<br>
</p></li>
<li><p>Now we plan to propose a new study with <span class="math inline">\(n = 30\)</span><br>
</p></li>
<li><p>At <span class="math inline">\(\alpha = 0.05\)</span>, what is the power?</p></li>
<li><p>We will use thise conditions:</p>
<ul>
<li><span class="math inline">\(\mu_1 = -5\)</span> (from pilot study)</li>
<li><span class="math inline">\(\sigma = 10\)</span> (from pilot study)</li>
<li><span class="math inline">\(n = 30\)</span> (provided)</li>
<li><span class="math inline">\(\alpha = 0.05\)</span> (provided</li>
</ul></li>
<li><p>We can calculate <span class="math inline">\(z_\alpha\)</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.05</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.645</code></pre>
</div>
</div></li>
<li><p>Plugging these into the power equation, we get <span class="math display">\[
\Phi\left(-1.645 + \frac{\sqrt{30}(0 - (-5))}{10} \right) = \Phi(1.094)
\]</span></p></li>
<li><p>Plugging this into R we get:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.094</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.863</code></pre>
</div>
</div></li>
</ul></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Exercise:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Mean birthweight in the US is 120 oz. What is the power to detect low birthweight in a study with:</p>
<ul>
<li><span class="math inline">\(n = 100\)</span><br>
</li>
<li><span class="math inline">\(\mu_1 = 115\)</span><br>
</li>
<li><span class="math inline">\(\alpha = 0.05\)</span><br>
</li>
<li><span class="math inline">\(\sigma = 24\)</span></li>
</ul>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Plugging in these values into the power equation, we have <span class="math display">\[
\text{Power} = \Phi\left(z_{0.05} + \frac{\sqrt{100}(120 - 115)}{24} \right)
\]</span> Doing this in R, we have</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fu">qnorm</span>(<span class="fl">0.05</span>) <span class="sc">+</span> <span class="fu">sqrt</span>(<span class="dv">100</span>) <span class="sc">*</span> (<span class="dv">120</span> <span class="sc">-</span> <span class="dv">115</span>) <span class="sc">/</span> <span class="dv">24</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6695</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>We can repeat this analysis to get the power for other alternatives:</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Power for z-tests
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assume <span class="math inline">\(H_0: \mu = \mu_0\)</span>.</p>
<ul>
<li>For <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>: <span class="math display">\[
\text{Power} = \Phi\left( z_\alpha + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma} \right)
\]</span></li>
<li>For <span class="math inline">\(H_1 : \mu &gt; \mu_0\)</span> <span class="math display">\[
\text{Power} = \Phi\left( z_\alpha + \frac{\sqrt{n}(\mu_1 - \mu_0)}{\sigma} \right)
\]</span></li>
<li>For <span class="math inline">\(H_1 : \mu \ne \mu_0\)</span> <span class="math display">\[
\text{Power} = \Phi\left( z_{\alpha/2} + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma} \right)
+ \Phi\left( z_{\alpha/2} + \frac{\sqrt{n}(\mu_1 - \mu_0)}{\sigma} \right)
\]</span></li>
</ul>
</div>
</div>
</section>
<section id="sample-size-calculation" class="level1">
<h1>Sample Size Calculation</h1>
<ul>
<li><p>Typically, you want a <strong>power</strong> of at least 0.8</p></li>
<li><p>So, what <span class="math inline">\(n\)</span> will give us power of 0.8?</p></li>
<li><p>Assume we have:</p>
<ol type="1">
<li>Guess of effect size: <span class="math inline">\(\mu_1 - \mu_0\)</span> (from pilot study or wild guess)<br>
</li>
<li>Guess of standard deviation <span class="math inline">\(\sigma\)</span> (from pilot study or wild guess)<br>
</li>
<li>Desired power = <span class="math inline">\(1 - \beta\)</span> (chosen by researcher)<br>
</li>
<li>Significance level <span class="math inline">\(\alpha\)</span> (chosen by researcher)</li>
</ol></li>
</ul>
<p>-Suppose we are testing - <span class="math inline">\(H_0: \mu = \mu_0\)</span> - <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span></p>
<ul>
<li><p>Start from power formula: <span class="math display">\[
1 - \beta = \Phi\left( z_\alpha + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma} \right)
\]</span></p>
<p>Now solve for <span class="math inline">\(n\)</span> (either numerically or algebraically):</p></li>
<li><p>Let’s try doing this by hand: <span class="math display">\[\begin{align*}
&amp;\Phi^{-1}(1 - \beta) = z_\alpha + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma}\\
&amp;\Leftrightarrow z_{1-\beta} = z_\alpha + \frac{\sqrt{n}(\mu_0 - \mu_1)}{\sigma}\\
&amp;\Leftrightarrow n = \frac{(z_{1-\beta} - z_\alpha)^2\sigma^2}{(\mu_0 - \mu_1)^2}\\
&amp;\Leftrightarrow n = \frac{(z_{1-\beta} + z_{1-\alpha})^2\sigma^2}{(\mu_0 - \mu_1)^2}
\end{align*}\]</span></p></li>
<li><p>It turns out that this calculation for <span class="math inline">\(n\)</span> is the exact same for <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span>.</p></li>
<li><p>For <span class="math inline">\(H_1: \mu \neq \mu_0\)</span>, the equation is a little more complicated.</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Sample Size for z-tests
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose <span class="math inline">\(H_0: \mu = \mu_0\)</span>.</p>
<ul>
<li>If <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> or <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span> then <span class="math display">\[
n = \frac{(z_{1-\beta} + z_{1-\alpha})^2\sigma^2}{(\mu_0 - \mu_1)^2}
\]</span></li>
<li>If <span class="math inline">\(H_1: \mu \neq \mu_0\)</span> then <span class="math display">\[
n = \frac{ (z_{1-\beta} + z_{1 - \alpha/2})^2\sigma^2}{(\mu_0 - \mu_1)^2}
\]</span></li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Exercise</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>What is the effect on <span class="math inline">\(n\)</span> of increasing</p>
<ol type="1">
<li><span class="math inline">\(\sigma\)</span><br>
</li>
<li><span class="math inline">\(\beta\)</span><br>
</li>
<li><span class="math inline">\(\alpha\)</span><br>
</li>
<li><span class="math inline">\(|\mu_0 - \mu_1|\)</span></li>
</ol>
<p>Try to reason both by using the power equations and by using common sense.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<ol type="1">
<li><span class="math inline">\(\sigma \uparrow \ \Rightarrow\ n \uparrow\)</span>
<ul>
<li>Intuitive reason: less precise measurements, so need more data.</li>
</ul></li>
<li><span class="math inline">\(\beta \uparrow \ \Rightarrow\ 1 - \beta \downarrow \ \Rightarrow\ z_{1 - \beta} \downarrow \ \Rightarrow\ n \downarrow\)</span>
<ul>
<li>Intuitive reason: less power needed, so we can have a smaller sample size.</li>
</ul></li>
<li><span class="math inline">\(\alpha \uparrow \ \Rightarrow 1-\alpha \downarrow \ \Rightarrow\ z_{1 - \alpha} \downarrow \ \Rightarrow\ n \downarrow\)</span>
<ul>
<li>Intuitive reason: less stringent test, so we can have a smaller sample size.</li>
</ul></li>
<li><span class="math inline">\(|\mu_0 - \mu_1| \uparrow \ \Rightarrow\ n \downarrow\)</span>
<ul>
<li>Intuitive reason: larger effect sizes are easier to detect, so we can have a smaller sample size.</li>
</ul></li>
</ol>
</div>
</div>
</div>
<hr>
<p><a href="../05_tests/05_power.html">Power Calculations in R</a></p>
<hr>
<p><strong>Skip Section 7.8</strong></p>
</section>
<section id="one-sample-inference-for-binomial" class="level1">
<h1>One-Sample Inference for Binomial</h1>
<ul>
<li><p>Example: Prevalence of breast cancer is 2%. Of 10,000 women whose mothers had breast cancer, 400 of them got breast cancer in their lives. Are they at higher risk?</p>
<ul>
<li>Let <span class="math inline">\(X\)</span> = number of those 10,000 who got breast cancer<br>
</li>
<li><span class="math inline">\(X \sim \text{Binom}(10{,}000,\ p)\)</span></li>
</ul>
<p><span class="math display">\[\begin{align*}
H_0 &amp;: p = 0.02 \\
H_1 &amp;: p &gt; 0.02
\end{align*}\]</span></p></li>
<li><p>One way to run this test is to use the normal approximation:</p></li>
<li><p><span class="math inline">\(\hat{p} = \frac{X}{n} \sim N\left(p_0,\ \frac{p_0(1 - p_0)}{n}\right)\)</span> under <span class="math inline">\(H_0\)</span></p>
<p>Then, by subtracing off the mean and dividing by the standard error: <span class="math display">\[
z = \frac{\hat{p} - p_0}{\sqrt{p_0(1 - p_0)/n}} \sim N(0, 1)
\]</span></p></li>
<li><p>Large values of <span class="math inline">\(z\)</span> indicate support that <span class="math inline">\(p\)</span> is larger than <span class="math inline">\(p_0\)</span>, so the <span class="math inline">\(p\)</span>-value is the probability (under <span class="math inline">\(H_0\)</span>) of being larger than what we saw: <span class="math display">\[
\text{p-value} = 1 - \Phi\left( \frac{\hat{p} - p_0}{\sqrt{p_0(1 - p_0)/n}} \right)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Normal curve with right tail shaded" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>If <span class="math inline">\(H_1: p \neq p_0\)</span> (two-sided), then calculate area in <strong>both tails</strong>.</p></li>
<li><p>Two-tailed p-value: <span class="math display">\[
\text{p-value} = 2 \cdot \Phi\left( -\left| \frac{\hat{p} - p_0}{\sqrt{p_0(1 - p_0)/n}} \right| \right)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Normal curve with shaded tails, showing two-sided test" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Because this is the normal approximation to the binomial, you can get better results with the continuity correction:</p>
<ul>
<li>Subtract <span class="math inline">\(\frac{1}{2n}\)</span> in the numerator for upper-tail test statistic<br>
</li>
<li>Add <span class="math inline">\(\frac{1}{2n}\)</span> in the numerator for lower-tail test statistic</li>
<li>These come from adding or subtracting half a count to the binomial count and then dividing by <span class="math inline">\(n\)</span> to get the binomial proportion.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>One-sample Binomial Test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X \sim \mathrm{Binom}(n,p)\)</span>, <span class="math inline">\(\hat{p} = X/n\)</span>, <span class="math inline">\(H_0: p = p_0\)</span></p>
<ul>
<li><span class="math inline">\(H_1: p &lt; p_0\)</span>
<ul>
<li><p>Test statistic: <span class="math display">\[
z = \frac{\hat{p}-p_0 + 1/(2n)}{\sqrt{p_0(1-p_0)/n}}
\]</span></p></li>
<li><p>Critical value (reject when <span class="math inline">\(z &lt; z_{\alpha}\)</span> <span class="math display">\[
z_{\alpha} = \texttt{qnorm}(\alpha)
\]</span></p></li>
<li><p><span class="math inline">\(p\)</span>-value <span class="math display">\[
\Phi(z)
\]</span></p></li>
<li><p>Graphic:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Normal curve with left tail shaded" width="192"></p>
</figure>
</div>
</div>
</div></li>
</ul></li>
<li><span class="math inline">\(H_1: p &gt; p_0\)</span>
<ul>
<li><p>Test statistic: <span class="math display">\[
z = \frac{\hat{p}-p_0 - 1/(2n)}{\sqrt{p_0(1-p_0)/n}}
\]</span></p></li>
<li><p>Critical value (reject when <span class="math inline">\(z &gt; z_{1-\alpha}\)</span> <span class="math display">\[
z_{1-\alpha} = \texttt{qnorm}(1-\alpha)
\]</span></p></li>
<li><p><span class="math inline">\(p\)</span>-value <span class="math display">\[
1 - \Phi(z)
\]</span></p></li>
<li><p>Graphic:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Normal curve with right tail shaded" width="192"></p>
</figure>
</div>
</div>
</div></li>
</ul></li>
<li><span class="math inline">\(H_1: p \neq p_0\)</span>
<ul>
<li><p>Test statistic: <span class="math display">\[
z = \frac{|\hat{p}-p_0| - 1/(2n)}{\sqrt{p_0(1-p_0)/n}}
\]</span></p></li>
<li><p>Critical value (reject when <span class="math inline">\(z &gt; z_{1-\alpha/2}\)</span> <span class="math display">\[
z_{1-\alpha/2} = \texttt{qnorm}(1 - \alpha/2)
\]</span></p></li>
<li><p><span class="math inline">\(p\)</span>-value <span class="math display">\[
2(1 - \Phi(z))
\]</span></p></li>
<li><p>Graphic:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Normal curve with shaded tails, showing two-sided test" width="192"></p>
</figure>
</div>
</div>
</div></li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li><p>Example: Back to the breast cancer example. We have <span class="math display">\[
\hat{p} = 400/10000 = 0.04
\]</span> Calculating our test statitistic, we have <span class="math display">\[
z = \frac{0.04 - 0.02 + 1/20000}{\sqrt{0.02(1-0.02)/10000}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.04</span> <span class="sc">-</span> <span class="fl">0.02</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20000</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fl">0.02</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.02</span>) <span class="sc">/</span> <span class="dv">10000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.32</code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value is the probability of being less than this statistic</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">14.32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.206e-47</code></pre>
</div>
</div>
<p>This is very significant.</p></li>
</ul>
<section id="exact-test" class="level2">
<h2 class="anchored" data-anchor-id="exact-test">Exact Test</h2>
<ul>
<li><p>We are still assuming that <span class="math inline">\(X \sim \text{Bin}(n, p)\)</span><br>
</p></li>
<li><p>Hypotheses:<br>
<span class="math inline">\(H_0: p = p_0\)</span><br>
<span class="math inline">\(H_1: p \ne p_0\)</span>, or <span class="math inline">\(p &gt; p_0\)</span>, or <span class="math inline">\(p &lt; p_0\)</span></p></li>
<li><p>The normal method only works for large <span class="math inline">\(n\)</span></p></li>
<li><p>Rule of thumb: You can use the normal method if <span class="math display">\[
n p_0(1 - p_0) \ge 5
\]</span></p></li>
<li><p>If <span class="math inline">\(n\)</span> is not large enough, use an exact test</p>
<ul>
<li>Controls for <span class="math inline">\(\alpha\)</span> for all <span class="math inline">\(n\)</span>, not just large <span class="math inline">\(n\)</span></li>
</ul></li>
<li><p>Under the null <span class="math inline">\(X \sim \mathrm{Binom}(n, p_0)\)</span>. We we observe <span class="math inline">\(x\)</span> (lower-case <span class="math inline">\(x\)</span>), then just calculate the probability from the binomial PMF of seeing values as weird or weirder.</p></li>
<li><p><span class="math inline">\(H_1: p &lt; p_0\)</span>: Calculate <span class="math inline">\(\Pr(X \leq x \mid p = p_0)\)</span> with <code>pbinom(q = x, size = n, prob = p0)</code></p></li>
<li><p>E.g., <span class="math inline">\(X = 3\)</span>, <span class="math inline">\(H_0: p_0 = 0.5\)</span>, <span class="math inline">\(H_1: p &lt; 0.5\)</span>. This the the PMF of <span class="math inline">\(X\)</span> under <span class="math inline">\(H_0\)</span> and the sum of the orange bars is the <span class="math inline">\(p\)</span>-value.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p><span class="math inline">\(H_1: p &gt; p_0\)</span>: Calculate <span class="math inline">\(\Pr(X \geq x \mid p = p_0)\)</span> with <code>1 - pbinom(q = x - 1, size = n, prob = p0)</code></p></li>
<li><p>E.g., <span class="math inline">\(X = 3\)</span>, <span class="math inline">\(H_0: p_0 = 0.5\)</span>, <span class="math inline">\(H_1: p_1 &gt; 0.5\)</span>. This the the PMF of <span class="math inline">\(X\)</span> under <span class="math inline">\(H_0\)</span> and the sum of the orange bars is the <span class="math inline">\(p\)</span>-value.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p><span class="math inline">\(H_1: p \neq p_0\)</span>: 2 times the smaller of <span class="math inline">\(\Pr(X \leq x \mid p = p_0)\)</span> or <span class="math inline">\(\Pr(X \geq x \mid p = p_0)\)</span>.</p></li>
<li><p>E.g., <span class="math inline">\(X = 3\)</span>, <span class="math inline">\(H_0: p_0 = 0.5\)</span>, <span class="math inline">\(H_1: p &lt; 0.5\)</span>. This the the PMF of <span class="math inline">\(X\)</span> under <span class="math inline">\(H_0\)</span> and the two times the sum of the orange bars is the <span class="math inline">\(p\)</span>-value.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>The exact <span class="math inline">\(p\)</span>-value formula for <span class="math inline">\(H_1: p \neq p_0\)</span> is <span class="math display">\[
\text{p-value} =
\begin{cases}
2 \sum_{k = 0}^{x} \binom{n}{k} p_0^k (1 - p_0)^{n - k} &amp; \text{ if } x \leq np_0\\
2 \sum_{k = x}^{n} \binom{n}{k} p_0^k (1 - p_0)^{n - k} &amp; \text{ if } x &gt; np_0
\end{cases}
\]</span></p></li>
<li><p>For <span class="math inline">\(H_1: p &lt; p_0\)</span>: <span class="math display">\[
\text{p-value} = \sum_{k = 0}^{x} \binom{n}{k} p_0^k (1 - p_0)^{n - k}
\]</span></p></li>
<li><p>For <span class="math inline">\(H_1: p &gt; p_0\)</span>: <span class="math display">\[
\text{p-value} = \sum_{k = x}^{n} \binom{n}{k} p_0^k (1 - p_0)^{n - k}
\]</span></p></li>
<li><p>Example: In a nuclear facility, there were 13 deaths, of which 5 were caused by cancer. Cancer causes 20% of deaths in this age group. Are there actually more cancer deaths than would be expected?</p>
<p>Let <span class="math inline">\(X\)</span> be the number of deaths caused by cancer out of 13. Then <span class="math inline">\(X \sim \text{Binom}(13, p)\)</span>. We are testing <span class="math inline">\(H_0: p = 0.2\)</span> versus <span class="math inline">\(H_1: p &gt; 0.2\)</span>. The <span class="math inline">\(p\)</span>-value is the probability of seeing at least 5 cancer deaths (out of 13) if indeed <span class="math inline">\(p = 0.2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">13</span>, <span class="at">prob =</span> <span class="fl">0.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09913</code></pre>
</div>
</div>
<p>This is a pretty large <span class="math inline">\(p\)</span>-value, so we do not have evidence that there are more cancer deaths than expected.</p></li>
</ul>
<hr>
<p><a href="../05_tests/05_binom.html">Binomial Tests in R</a></p>
<hr>
</section>
</section>
<section id="power-calculations-for-binomial-tests" class="level1">
<h1>Power Calculations for Binomial Tests</h1>
<p>We want: <span class="math display">\[
\text{Power} = \Pr(\text{Reject } H_0 \mid H_1)
\]</span></p>
<ul>
<li><p>Need:</p>
<ul>
<li>True alternative value: <span class="math inline">\(p_1\)</span> (wild guess or pilot study)</li>
<li>Sample size: <span class="math inline">\(n\)</span> (provided by researcher)</li>
<li>Significance level: <span class="math inline">\(\alpha\)</span> (provided by researcher)</li>
</ul></li>
<li><p>We’ll skip the derivation, but we are using the normal approximation.</p></li>
<li><p>It’s very similar to the normal power calculations. E.g., here is a visual of the power calculation when <span class="math inline">\(H_1: p &lt; p_0\)</span>:</p>
<p><img src="./05_figs/power_binom_test.png" class="img-fluid">&nbsp;</p></li>
<li><p>For the two-sided test (<span class="math inline">\(H_1: p \ne p_0\)</span>), power is approximated as:</p>
<p><span class="math display">\[
\Phi\left(\sqrt{\frac{p_0(1-p_0)}{p_1(1-p_1)}\left(z_{\alpha/2} + \frac{|p_0 - p_1|\sqrt{n}}{\sqrt{p_0(1-p_0)}}\right)}\right)
\]</span></p></li>
<li><p>I don’t expect you remember this, but you should be able to say something about it if I show it to you. Like these summaries.</p></li>
<li><p>Summary of effects on power:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 19%">
<col style="width: 25%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Change</th>
<th>Effect on Power</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(n\)</span></td>
<td>↑</td>
<td>Power ↑</td>
<td>More data</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha\)</span></td>
<td>↑</td>
<td>Power ↑</td>
<td>Less stringent test</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(|p_0 - p_1|\)</span></td>
<td>↑</td>
<td>Power ↑</td>
<td>More signal</td>
</tr>
</tbody>
</table></li>
<li><p>For sample size calculations, need:</p>
<ol type="1">
<li>True alternative <span class="math inline">\(p_1\)</span> (wild guess, or from a pilot study)</li>
<li>Desired power <span class="math inline">\(1 - \beta\)</span> (from researcher)</li>
<li>Significance level <span class="math inline">\(\alpha\)</span> (from researcher)</li>
</ol></li>
<li><p>To get <span class="math inline">\(n\)</span>, we first set: <span class="math display">\[
1 - \beta = \Phi\left(\sqrt{\frac{p_0(1-p_0)}{p_1(1-p_1)}\left(z_{\alpha/2} + \frac{|p_0 - p_1|\sqrt{n}}{\sqrt{p_0(1-p_0)}}\right)}\right)
\]</span> Then solve for <span class="math inline">\(n\)</span>. The equation is in the book.</p></li>
</ul>
<hr>
<p><a href="../05_tests/05_binom_power.html">Power Calculations in R</a></p>
<hr>
</section>
<section id="poisson-test" class="level1">
<h1>Poisson Test</h1>
<ul>
<li><p>Let <span class="math inline">\(X \sim \text{Poisson}(\mu)\)</span></p></li>
<li><p>Hypotheses:</p>
<ul>
<li><span class="math inline">\(H_0: \mu = \mu_0\)</span><br>
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu \ne \mu_0\)</span>, or <span class="math inline">\(\mu &gt; \mu_0\)</span>, or <span class="math inline">\(\mu &lt; \mu_0\)</span></li>
</ul></li>
<li><p>The <span class="math inline">\(p\)</span>-value is calculated using exact approaches. Very similar to the binomial approach.</p></li>
<li><p><span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>: Then calculate <span class="math inline">\(\Pr(X \leq x \mid \mu = \mu_0)\)</span> via <code>ppois(q = x, lambda = mu0)</code></p></li>
<li><p>E.g., we observe <span class="math inline">\(x = 3\)</span> and our hypotheses are <span class="math inline">\(H_0: \mu = 5\)</span> and <span class="math inline">\(H_1: \mu &lt; 5\)</span>. Then the <span class="math inline">\(p\)</span>-value is the probability of being less than or equal to 3 given <span class="math inline">\(\mu = 5\)</span> (sum of orange bars).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p><span class="math inline">\(H_1: \mu &gt; \mu_0\)</span>: Then calculate <span class="math inline">\(\Pr(X \geq x \mid \mu = \mu_0)\)</span> via <code>1 - ppois(q = x - 1, lambda = mu0)</code></p></li>
<li><p>E.g., we observe <span class="math inline">\(x = 3\)</span> and our hypotheses are <span class="math inline">\(H_0: \mu = 5\)</span> and <span class="math inline">\(H_1: \mu &gt; 5\)</span>. Then the <span class="math inline">\(p\)</span>-value is the probability of being greater than or equal to 3 given <span class="math inline">\(\mu = 5\)</span> (sum of orange bars).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p><span class="math inline">\(H_1: \mu \neq \mu_0\)</span>: Sum over all values of <span class="math inline">\(x\)</span> less probable than observed <span class="math inline">\(x\)</span>.</p>
<p>Let <span class="math inline">\(x\)</span> be the observed count. Then:</p>
<p><span class="math display">\[
\text{p-value} = \sum_{h : \Pr(h) \le \Pr(x)} \Pr(h) = \sum_{h : \Pr(h) \le \Pr(x)} \frac{e^{-\mu_0} \mu_0^h}{h!}
\]</span></p></li>
<li><p>E.g., we observe <span class="math inline">\(x = 3\)</span> and our hypotheses are <span class="math inline">\(H_0: \mu = 5\)</span> and <span class="math inline">\(H_1: \mu \neq 5\)</span>. Then the <span class="math inline">\(p\)</span>-value is sum of all probabilities less than that of <span class="math inline">\(3\)</span> (sum of orange bars).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Example: 8418 rubber workers, ages 40–84. 4 deaths due to Hodgkin’s disease. We expect about 3.3. deaths based on US mortality rates.</p>
<p>Let <span class="math inline">\(X\)</span> = # with Hodgkin’s. We assume <span class="math inline">\(X \sim \text{Poisson}(\mu)\)</span>. We are testing <span class="math display">\[\begin{align*}
H_0 &amp;: \mu = 3.3 \\
H_1 &amp;: \mu \ne 3.3
\end{align*}\]</span></p>
<p>In R, there is an easy function for the Poisson test:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">r =</span> <span class="fl">3.3</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1   0.578</code></pre>
</div>
</div>
<p>The p-value is 0.5783, so we fail to reject the null and conclude that we do not have enough evidence that rubber workers have different Hodgkins disease rates from the general public.</p>
<!-- - Note: -->
<!--   - Binomial test is not appropriate here because each individual has a different $p_i$. -->
<!--     - The binomial test requires each individual to have the same $p_i$. -->
<!--   - The $\mu_0$ was calculated from the expected $p_i$ for each individual. --></li>
<li><p>Standardized Mortality Ratio (SMR) <span class="math display">\[
\text{SMR} = \frac{\text{Observed}}{\text{Expected}} \times 100\%
\]</span></p>
<ul>
<li><span class="math inline">\(\text{SMR} &gt; 100\%\)</span> <span class="math inline">\(\Rightarrow\)</span> more deaths than expected in the study population.</li>
<li><span class="math inline">\(\text{SMR} &lt; 100\%\)</span> <span class="math inline">\(\Rightarrow\)</span> fewer deaths than expected in the study population.</li>
<li><span class="math inline">\(\text{SMR} = 100\%\)</span> <span class="math inline">\(\Rightarrow\)</span> same number of deaths as expected in the study population.</li>
</ul></li>
<li><p>Example: Observed = 4, Expected = 3.3 <span class="math display">\[
\text{SMR} = \frac{4}{3.3} \times 100\% \approx 121\%
\]</span></p></li>
</ul>
</section>
<section id="exercises-7.17.8" class="level1">
<h1>Exercises 7.1–7.8</h1>
<p>The mean serum-creatinine level measured in 12 patients 24 hours after they received a newly proposed antibiotic was 1.2 mg/dL.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Exercise 7.1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>If the mean and standard deviation of serum creatinine in the general population are 1.0 and 0.4 mg/dL, respectively, then, using a significance level of .05, test whether the mean serum-creatinine level in this group is different from that of the general population.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>We have <span class="math inline">\(\bar{x} = 1.2\)</span>, <span class="math inline">\(n = 12\)</span>, and we are testing <span class="math inline">\(H_0: \mu = 1.0\)</span> versus <span class="math inline">\(H_1: \mu \neq 1.0\)</span>.</p>
<p>The problem didn’t give you the sample standard deviation, so you have to assume the variance is known with <span class="math inline">\(\sigma = 0.4\)</span>.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>We have <span class="math inline">\(\bar{x} = 1.2\)</span>, <span class="math inline">\(n = 12\)</span>, and we are testing <span class="math inline">\(H_0: \mu = 1.0\)</span> versus <span class="math inline">\(H_1: \mu \neq 1.0\)</span>.</p>
<p>The problem didn’t give you the sample standard deviation, so you have to assume the variance is known with <span class="math inline">\(\sigma = 0.4\)</span>.</p>
<p>We calculate a <span class="math inline">\(z\)</span> statistic</p>
<p><span class="math display">\[
z = \frac{1.2 - 1}{0.4 / \sqrt{12}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1.2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="fl">0.4</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.732</code></pre>
</div>
</div>
<p>Rosner wants you to use the critical method in this question and the <span class="math inline">\(p\)</span>-value in the next question. The critical value at the 0.05 level of the two-sided test is:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.96</code></pre>
</div>
</div>
<p>Since 1.732 &lt; 1.96, we fail to reject the null at the 0.05 level and conclude that we do not have evidence that the mean serum creatine level in this group is different than the general population.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Exercise 7.2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>What is the p-value for the test?</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">

</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>We compare this to a standard normal distribution to get the <span class="math inline">\(p\)</span>-value. We multiply by 2 because this is a two-sided test.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">1.732</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08327</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Exercise 7.3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Suppose the sample standard deviation of serum creatinine in Problem 7.1 is 0.6 mg/dL. Assume that the standard deviation of serum creatinine is not known, and perform the hypothesis test in Problem 7.1. Report a p-value.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Very similar to 7.1 and 7.2, but use <span class="math inline">\(s = 0.6\)</span> and a <span class="math inline">\(t\)</span>-distribution with the appropriate degrees of freedom.</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>We have <span class="math inline">\(\bar{x} = 1.2\)</span>, <span class="math inline">\(s = 0.6\)</span>, and <span class="math inline">\(n = 12\)</span>. We are testing <span class="math inline">\(H_0: \mu = 1\)</span> versus <span class="math inline">\(H_1: \mu \neq 1\)</span>. We calculate the <span class="math inline">\(t\)</span>-statistic <span class="math display">\[
t = \frac{1.2 - 1}{0.6/\sqrt{12}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1.2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="fl">0.6</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.155</code></pre>
</div>
</div>
<p>We compare this to a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1 = 12-1 = 11\)</span> degrees of freedom.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fl">1.155</span>, <span class="at">df =</span> <span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2726</code></pre>
</div>
</div>
<p>With a <span class="math inline">\(p\)</span>-value of 0.2726, we fail to reject the null hypothesis and conclude that we do not have evidence that this group has a different mean serum creatine level than the general population.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Exercise 7.4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Compute a two-sided 95% CI for the true mean serum-creatinine level in Problem 7.3.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>“Estimate <span class="math inline">\(\pm\)</span> Multiplier <span class="math inline">\(\times\)</span> standard error”</p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>Our estimate is <span class="math inline">\(\bar{x} = 1.2\)</span>. The standard error is <span class="math inline">\(s / \sqrt{n} = 0.6 / \sqrt{12} = 0.1732\)</span>. We need the <span class="math inline">\(1-\alpha/2\)</span> quantile of the <span class="math inline">\(t_{11}\)</span> distribution. Since the level is 0.95, <span class="math inline">\(\alpha = 1 - 0.95 = 0.05\)</span>. Thus, the multiplier is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.201</code></pre>
</div>
</div>
<p>Our interval is “Estimate <span class="math inline">\(\pm\)</span> Multiplier <span class="math inline">\(\times\)</span> SE”, or <span class="math inline">\(\bar{x} \pm t_{1-\alpha/2,n-1}s/\sqrt{n}\)</span>. Which is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="sc">-</span> <span class="fl">2.201</span> <span class="sc">*</span> <span class="fl">0.1732</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8188</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">2.201</span> <span class="sc">*</span> <span class="fl">0.1732</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.581</code></pre>
</div>
</div>
<p>We are 95% confident that mean serum creatine is between 0.8188 and 1.581 mg/dL.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Exercise 7.5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>How does your answer to Problem 7.4 relate to your answer to Problem 7.3.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>What’s the connection between confidence intervals and hypothesis testing</p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>The 95% confidence interval contains 1. So a test of <span class="math inline">\(H_0: \mu = 1\)</span> has a <span class="math inline">\(p\)</span>-value greater than 0.05.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">Exercise 7.6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Suppose <span class="math inline">\(\frac{\bar{x} - \mu_0}{s/\sqrt{n}} = 1.52\)</span> and a one-sample t test is performed based on seven subjects. What is the two-tailed p-value?</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Multiply tail area by 2.</p>
<p>Degrees of freedom is <span class="math inline">\(n-1\)</span></p>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>We compare this value to a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-1=7-1=6\)</span> degrees of freedom.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fl">1.52</span>, <span class="at">df =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1793</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_notes_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Exercise 7.7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Use a computer program to compute the probability that a t distribution with 36 df exceeds 2.5.</p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Use the CDF</p>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fl">2.6</span>, <span class="at">df =</span> <span class="dv">36</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.006718</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">Exercise 7.8</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>Use a computer program to compute the lower 10th percentile of a t distribution with 54 df.</p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>Use <code>qt()</code>.</p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">df =</span> <span class="dv">54</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.297</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercises-7.527.55" class="level1">
<h1>Exercises 7.52–7.55</h1>
<p>Researchers have reported that the incidence rate of cataracts may be elevated among people with excessive exposure to sunlight. To confirm this, a pilot study is conducted among 200 people ages 65–69 who report an excessive tendency to burn on exposure to sunlight. Of the 200 people, 4 develop cataracts over a 1-year period. Suppose the expected incidence rate of cataracts among 65- to 69-year-olds is 1% over a 1-year period.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">Exercise 7.52</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>What test procedure can be used to compare the 1-year rate of cataracts in this population with that in the general population?</p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>Let <span class="math inline">\(X\)</span> be the number, out of 200, who develop cataracts. What distribution does it follow?</p>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>Let <span class="math inline">\(X\)</span> be the number, out of 200, who develop cataracts. Then <span class="math inline">\(X \sim \mathrm{Binom}(200, p)\)</span>. We are testing <span class="math inline">\(H_0: p = 0.01\)</span> versus <span class="math inline">\(H_0: p \neq 0.01\)</span>.</p>
<p>Let’s calculate our rule of thumb (<span class="math inline">\(p_0(1-p_0)n \geq 5\)</span>) to see if we have to use an exact approach.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.01</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.01</span>) <span class="sc">*</span> <span class="dv">200</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.98</code></pre>
</div>
</div>
<p>Since this is less than 5, we have to use an exact binomial approach.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">Exercise 7.53</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>Implement the test procedure in Problem 7.52, and report a p-value (two-sided). Do this both “by hand” and using an appropriate R function.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>Use <code>pbinom()</code>. Do you multiply by 2?</p>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<p>The Rosner way is to use 2 times the probability of being at least 4 given <span class="math inline">\(p = 0.01\)</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">200</span>, <span class="at">prob =</span> <span class="fl">0.01</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2839</code></pre>
</div>
</div>
<p>R’s default way is to sum over probabilities less than that of 4 (given <span class="math inline">\(p = 0.01\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">200</span>, <span class="at">prob =</span> <span class="fl">0.01</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">size =</span> <span class="dv">200</span>, <span class="at">prob =</span> <span class="fl">0.01</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pmf[pmf <span class="sc">&lt;=</span> p4])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.142</code></pre>
</div>
</div>
<p>We can get R’s <span class="math inline">\(p\)</span>-value just by <code>binom.test()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">p =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1   0.142</code></pre>
</div>
</div>
<p>Either way, we fail to reject the null and say that we do not have enough evidence to conclude that these folks have different rates of cataracts than the general population.</p>
</div>
</div>
</div>
<p>The researchers decide to extend the study to a 5-year period and find that 20 of the 200 people develop a cataract over a 5-year period. Suppose the expected incidence of cataracts among 65- to 69-year-olds in the general population is 5% over a 5-year period.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Exercise 7.54</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>Test the hypothesis that the 5-year incidence rate of cataracts is different in the excessive-sunlight-exposure group compared with the general population, and report a p-value (two-sided).</p>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>The exact approach is the same as 7.53, just with different numbers. So try the normal approach. Don’t forget the continuity correction.</p>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p>Let <span class="math inline">\(X\)</span> be the number of cataracts out of 200 over the five year period. Then <span class="math inline">\(X \sim \mathrm{Binom}(200, p)\)</span>. We are testing <span class="math inline">\(H_0: p = 0.05\)</span> versus <span class="math inline">\(p \neq 0.05\)</span>.</p>
<p>We can actually use the normal method if we want:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>) <span class="sc">*</span> <span class="dv">200</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.5</code></pre>
</div>
</div>
<p>The exact method is the same as before, just changing numbers around. In R, this results in</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">p =</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1 0.00307</code></pre>
</div>
</div>
<p>For the normal method, let’s get a <span class="math inline">\(z\)</span> value. We have <span class="math inline">\(\hat{p} = 20/200 = 0.1\)</span>. <span class="math display">\[
z = \frac{|0.1 - 0.05| - 1 / 400}{\sqrt{0.05(1-0.05)/200}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">abs</span>(<span class="fl">0.1</span> <span class="sc">-</span> <span class="fl">0.05</span>) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">400</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="dv">200</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.082</code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value using the normal based approach is</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">3.082</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002056</code></pre>
</div>
</div>
<p>This agrees with R’s <code>prop.test()</code></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">p =</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1 0.00205</code></pre>
</div>
</div>
<p>Either way, we reject <span class="math inline">\(H_0\)</span> and conclude that this population has different rates of cataracts than the general population.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">Exercise 7.55</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Hint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>Construct a 95% CI for the 5-year true rate of cataracts among the excessive-sunlight-exposure group.</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<p>Do a Wald interval.</p>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>The Wald interval is <span class="math display">\[
\hat{p} \pm z_{1-\alpha/2}\sqrt{\hat{p}(1-\hat{p})/n}
\]</span> Plugging in numbers, we have</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.1</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.1</span>) <span class="sc">/</span> <span class="dv">200</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05842</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">0.1</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.1</span>) <span class="sc">/</span> <span class="dv">200</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1416</code></pre>
</div>
</div>
<p>This differs from the Wilson intervals in R</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pout <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">200</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>pout<span class="sc">$</span>conf.int</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06366 0.15230
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>